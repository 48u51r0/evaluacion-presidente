mutate(id = as.numeric(
paste0(as.character(backup_3277$ESTU),
as.character(backup_3277$CUES))
),
Periodo = 4,
RV = case_when(RECUVOTOGR %in% c(5, 6, 21,67) ~ 5, #UP
RECUVOTOGR %in% c(7, 50) ~ 7,       #MPais
RECUVOTOGR == 1 ~ 1, #PP
RECUVOTOGR == 2 ~ 2, #PSOE
RECUVOTOGR == 4 ~ 4, #Cs
RECUVOTOGR == 18 ~ 18, #VOX
RECUVOTOGR >= 96 ~ NA_real_, #
TRUE ~ 99) %>%
factor(levels = c(1, 2, 4, 5, 7, 18, 99),
labels = c("PP", "PSOE", "Cs", "UP", "MP", "VOX", "Otros")
) %>%
relevel(2),
eval_pres = case_when(as.numeric(A17_1)  %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(A17_1)),
evalpres_GMC = eval_pres - mean(eval_pres, na.rm = TRUE),
A17_2 = case_when(as.numeric(A17_2) %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(A17_2)),
A17_3 = case_when(as.numeric(A17_3) %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(A17_3)),
A17_4 = case_when(as.numeric(A17_4) %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(A17_4)),
A17_5 = case_when(as.numeric(A17_5) %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(A17_5)),
A17_6 = case_when(as.numeric(A17_6) %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(A17_6)),
A17_7 = case_when(as.numeric(A17_7) %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(A17_7)),
eval_opos = pmax(A17_2, A17_3, A17_4, A17_5, A17_6, A17_7, na.rm = TRUE),
ideol_pers = case_when(as.numeric(ESCIDEOL)  %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(ESCIDEOL)),
ideolpers_GMC = ideol_pers - mean(ideol_pers, na.rm = TRUE),
ideol_pres = case_when(as.numeric(ESCIDEOLPOLI_1)  %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(ESCIDEOLPOLI_1)),
dist_ideo = ideol_pers - ideol_pres,
distideo_GMC= dist_ideo - mean(dist_ideo, na.rm = TRUE),
dist_eval = eval_pres - eval_opos,
ideol_2 = ideolpers_GMC^2,
ideol_3 = ideolpers_GMC^3,
distideo_2 = distideo_GMC^2,
distideo_3 = distideo_GMC^3,
man = case_when(SEXO == 1 ~ 1L,
SEXO == 2 ~ 0L,
TRUE ~ NA_integer_) %>%
factor(levels = c(0, 1),
labels = c("Mujer", "Hombre")
) %>%
relevel(1),
higher_educ = case_when(NIVELESTENTREV %in% c(1:8, 17) ~ 0L,
NIVELESTENTREV %in% 9:16 ~ 1L,
TRUE ~ NA_integer_) %>%
factor(levels = c(0, 1),
labels = c("Universitario", "No-Universitario")
) %>%
relevel(1),
welloff = case_when(CLASESOCIAL %in% 1:3 ~ 1L, #high, middle-high, middle-middle
CLASESOCIAL %in% 4:11 ~ 0L,
TRUE ~ NA_integer_) %>%
factor(levels = c(0, 1),
labels = c("Medio-alto", "Bajo")
) %>%
relevel(1)
) %>%
select(id, Periodo, dist_eval, eval_pres, evalpres_GMC, eval_opos, ideol_pers,ideolpers_GMC, ideol_2, ideol_3, distideo_GMC, distideo_2, distideo_3, RV, man, higher_educ, welloff, PESO) %>%
drop_na() %>%
write_rds("df_3277.rds")
df_3277 <- read_rds("backup_3277.rds") %>%
mutate(id = as.numeric(
paste0(as.character(ESTU),
as.character(CUES))
)
)
df_3277$id
df_3277 <- read_rds("backup_3277.rds") %>%
mutate(id = as.numeric(
paste0(as.character(ESTU),
as.character(CUES))
),
Periodo = 4,
RV = case_when(RECUVOTOGR %in% c(5, 6, 21,67) ~ 5, #UP
RECUVOTOGR %in% c(7, 50) ~ 7,       #MPais
RECUVOTOGR == 1 ~ 1, #PP
RECUVOTOGR == 2 ~ 2, #PSOE
RECUVOTOGR == 4 ~ 4, #Cs
RECUVOTOGR == 18 ~ 18, #VOX
RECUVOTOGR >= 96 ~ NA_real_, #
TRUE ~ 99) %>%
factor(levels = c(1, 2, 4, 5, 7, 18, 99),
labels = c("PP", "PSOE", "Cs", "UP", "MP", "VOX", "Otros")
) %>%
relevel(2),
eval_pres = case_when(as.numeric(A17_1)  %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(A17_1)),
evalpres_GMC = eval_pres - mean(eval_pres, na.rm = TRUE),
A17_2 = case_when(as.numeric(A17_2) %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(A17_2)),
A17_3 = case_when(as.numeric(A17_3) %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(A17_3)),
A17_4 = case_when(as.numeric(A17_4) %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(A17_4)),
A17_5 = case_when(as.numeric(A17_5) %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(A17_5)),
A17_6 = case_when(as.numeric(A17_6) %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(A17_6)),
A17_7 = case_when(as.numeric(A17_7) %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(A17_7)),
eval_opos = pmax(A17_2, A17_3, A17_4, A17_5, A17_6, A17_7, na.rm = TRUE),
ideol_pers = case_when(as.numeric(ESCIDEOL)  %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(ESCIDEOL)),
ideolpers_GMC = ideol_pers - mean(ideol_pers, na.rm = TRUE),
ideol_pres = case_when(as.numeric(ESCIDEOLPOLI_1)  %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(ESCIDEOLPOLI_1)),
dist_ideo = ideol_pers - ideol_pres,
distideo_GMC= dist_ideo - mean(dist_ideo, na.rm = TRUE),
dist_eval = eval_pres - eval_opos,
ideol_2 = ideolpers_GMC^2,
ideol_3 = ideolpers_GMC^3,
distideo_2 = distideo_GMC^2,
distideo_3 = distideo_GMC^3,
man = case_when(SEXO == 1 ~ 1L,
SEXO == 2 ~ 0L,
TRUE ~ NA_integer_) %>%
factor(levels = c(0, 1),
labels = c("Mujer", "Hombre")
) %>%
relevel(1),
higher_educ = case_when(NIVELESTENTREV %in% c(1:8, 17) ~ 0L,
NIVELESTENTREV %in% 9:16 ~ 1L,
TRUE ~ NA_integer_) %>%
factor(levels = c(0, 1),
labels = c("Universitario", "No-Universitario")
) %>%
relevel(1),
welloff = case_when(CLASESOCIAL %in% 1:3 ~ 1L, #high, middle-high, middle-middle
CLASESOCIAL %in% 4:11 ~ 0L,
TRUE ~ NA_integer_) %>%
factor(levels = c(0, 1),
labels = c("Medio-alto", "Bajo")
) %>%
relevel(1)
) %>%
select(id, Periodo, dist_eval, eval_pres, evalpres_GMC, eval_opos, ideol_pers,ideolpers_GMC, ideol_2, ideol_3, distideo_GMC, distideo_2, distideo_3, RV, man, higher_educ, welloff, PESO) %>%
drop_na() %>%
write_rds("df_3277.rds")
source('C:/Users/Usuario/OneDrive - Universidad Complutense de Madrid (UCM)/R_projects/Paper_08042020/Scripts/Generar_Datos.R', encoding = 'WINDOWS-1252', echo=TRUE)
df_3269 <- read_rds("df_3269.rds")
df_3271 <- read_rds("df_3271.rds")
df_3273 <- read_rds("df_3273.rds")
df_3277 <- read_rds("df_3277.rds")
pooled <- bind_rows(df_3269, df_3271, df_3273, df_3277) %>%
mutate(Periodo = factor(Periodo, levels = 1:5,
labels = c("Poselectoral", "Enero", "Febrero", "Marzo", "Abril")
),
ideologia = factor(ideol_pers, levels = 1:10)
)
ggplot(pooled, aes(y = eval_pres, x = ideologia))+
stat_summary(fun=mean,geom="point",aes(group= Periodo,colour=Periodo))+
stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = .1, aes(group= Periodo,colour=Periodo))+
stat_summary(fun = mean, geom = "line",aes(group= Periodo,colour=Periodo)) +
labs(x = "Autoubicación ideológica (1-10)", y = "Valoración del presidente (1-10)")
mod_int <- lm(eval_pres ~ ideologia * Periodo, data=pooled, weights = PESO)
summary(mod_int)
mod_int_r <- rlm(eval_pres ~ ideologia * Periodo, data=pooled, weights = PESO)
mod_int <- lm(formula = eval_pres ~ ideologia * Periodo, data=pooled, weights = PESO)
mod_int_r <- rlm(formula = eval_pres ~ ideologia * Periodo, data=pooled, weights = PESO)
rlm
rlm(eval_pres ~ ideologia, data = pooled)
rlm(eval_pres ~ ideologia * Periodo, data = pooled)
rlm(eval_pres ~ ideologia +Periodo, data = pooled)
rlm(eval_pres ~ Periodo, data = pooled)
class(pooled$Periodo)
class(pooled$ideologia)
str(pooled$Periodo)
summary(pooled$Periodo)
summary(pooled$ideologia)
sum(summary(pooled$ideologia))
sum(summary(pooled$Periodo))
rlm(eval_pres_GMC ~ P+eriodo, data = pooled)
rlm(eval_pres_GMC ~ Periodo, data = pooled)
pooled$evalpres_GMC
rlm(eval_pres_GMC ~ Periodo, data = pooled)
rlm(evalpres_GMC ~ Periodo, data = pooled)
rlm(evalpres_GMC ~ ideologia, data = pooled)
a <- data.frame(pooled$ideologia, pooled$Periodo)
a
min(pooled$Periodo)
mod_int <- lm(eval_pres ~ ideologia * Periodo, data=pooled, weights = PESO)
mod_ad < lm(eval_pres ~ ideologia + Periodo, data=pooled, weights = PESO)
fit_int<-aov(mod_inter)
fit_aditivo <- aov(mod_ad)
summary(c(fit_int, fit_ad))
mod_ad < lm(eval_pres ~ ideologia + Periodo, data=pooled, weights = PESO)
mod_int <- lm(eval_pres ~ ideologia * Periodo, data=pooled, weights = PESO)
mod_ad < lm(eval_pres ~ ideologia + Periodo, data=pooled, weights = PESO)
mod_ad <- lm(eval_pres ~ ideologia + Periodo, data=pooled, weights = PESO)
fit_int<-aov(mod_inter)
fit_aditivo <- aov(mod_ad)
summary(c(fit_int, fit_ad))
fit_int
fit_int <- aov(mod_int)
fit_aditivo <- aov(mod_ad)
summary(c(fit_int, fit_ad))
fit_ad <- aov(mod_ad)
summary(c(fit_int, fit_ad))
summary(fit_int)
summary(fit_ad)
tukey_glht_sw_int <- glht(model = fit_int,
linfct = lsm(pairwise ~ ideologia:Periodo),
by = NULL,
vcov = sandwich)
df_3269 <- read_rds("df_3269.rds")
df_3271 <- read_rds("df_3271.rds")
df_3273 <- read_rds("df_3273.rds")
df_3277 <- read_rds("df_3277.rds")
pooled <- bind_rows(df_3269, df_3271, df_3273, df_3277) %>%
mutate(Periodo = factor(Periodo, levels = 1:5,
labels = c("Poselectoral", "Enero", "Febrero", "Marzo", "Abril")
),
ideologia = factor(ideol_pers, levels = 1:10)
)
mod_int <- lm(eval_pres ~ ideologia * Periodo, data=pooled, weights = PESO)
mod_ad <- lm(eval_pres ~ ideologia + Periodo, data=pooled, weights = PESO)
fit_int <- aov(mod_int)
fit_ad <- aov(mod_ad)
#comprobar en el libro-manual
pairwise.t.test(pooled$eval_pres,pooled$niveduc,p.adjust="bonferroni")
tukey <- fit_int %>%
TukeyHSD() %>% #it's a list of matrices: main fx + interaction fx
#seleccionamos las diferencias significativas al p-value 0.05
map(~.[.[, "p adj"] < 0.05,] %>% #substting a matrix that meets a condition
as.data.frame %>%
rownames_to_column(var = "Categories") %>%
arrange(Categories)
)
interaction <- tukey %>%
pluck("ideologia:Periodo") %>% #selecciona el elemento de una lista
mutate(aux_ideol1 = str_match(Categories, pattern = "^(.*?):")[, 2],
aux_periodo1 = str_match(Categories, pattern = ":(.*?)-")[, 2],
aux_ideol2  = str_match(Categories, pattern = "-(.*?):")[, 2],
aux_periodo2= word(Categories, 3, sep = fixed(':')),
ubicacion_1 = as.numeric(pmin(aux_ideol1, aux_ideol2)),
periodo_1 = if_else(aux_ideol1 == ubicacion_1, aux_periodo1, aux_periodo2) %>%
factor(levels = levels(pooled$Periodo)),
ubicacion_2 = as.numeric(pmax(aux_ideol1, aux_ideol2)),
periodo_2 = if_else(aux_ideol2 == ubicacion_2, aux_periodo2, aux_periodo1) %>%
factor(levels = levels(pooled$Periodo)),
diff_adj = if_else(aux_ideol1 == ubicacion_1, diff, -1*diff),
upr_adj = diff_adj + abs((upr - lwr) / 2),
lwr_adj = diff_adj - abs((upr - lwr) / 2)
) %>%
arrange(ubicacion_1, periodo_1, periodo_2, ubicacion_2) %>%
select(ubicacion_1, periodo_1, ubicacion_2, periodo_2, diff_adj, upr_adj, lwr_adj, 'p adj')
view(interaction)
with(interaction, ubicacion_1 == ubicacion_2)
interaction[with(interaction, ubicacion_1 == ubicacion_2), ]
head(sort(interaction$periodo_1))
head(pmin(interaction$periodo_1, interaction$periodo_2)
)
interaction$periodo_1[1]<interaction$periodo_2[1]
a <- ordered(interaction$periodo_1)
b <- ordered(interaction$periodo_2)
interaction$periodo_1[1]<interaction$periodo_2[1]
interaction$periodo_1[1
]
levels(a[1])
as.numeric(a)
data.frame(a[1:30], as.numeric(a[1:30]))
class(pooled$ideologia)
interaction2 <- tukey %>%
pluck("ideologia:Periodo") %>% #selecciona el elemento de una lista
mutate(aux_ideol1 = str_match(Categories, pattern = "^(.*?):")[, 2],
aux_periodo1 = str_match(Categories, pattern = ":(.*?)-")[, 2],
aux_ideol2  = str_match(Categories, pattern = "-(.*?):")[, 2],
aux_periodo2= word(Categories, 3, sep = fixed(':')),
periodo_1 = if_else(as.numeric(aux_periodo1) <= as.numeric(aux_periodo2),
aux_periodo1, aux_periodo2) %>%
factor(levels = levels(pooled$Periodo)),
ubicacion_1 = if_else(aux_periodo1 == periodo_1,
if_else(periodo_1 != aux_periodo2,
aux_ideol1,
pmin(aux_ideol1, aux_ideol2)),
aux_ideol2) %>%
factor(levels = levels(pooled$ideologia)),
periodo_2 = if_else(aux_periodo1 == periodo_1, aux_periodo2, aux_periodo1) %>%
factor(levels = levels(pooled$Periodo)),
ubicacion_2 = if_else(ubicacion_1 == aux_ideol1 & periodo_1 == aux_periodo1,
aux_ideol2,
aux_ideol1) %>%
factor(levels = levels(pooled$ideologia)),
diff_adj = if_else(aux_ideol1 == ubicacion_1 & aux_periodo1 == periodo_1, diff, -1*diff),
upr_adj = diff_adj + abs((upr - lwr) / 2),
lwr_adj = diff_adj - abs((upr - lwr) / 2)
) %>%
arrange(ubicacion_1, periodo_1, periodo_2, ubicacion_2) %>%
select(ubicacion_1, periodo_1, ubicacion_2, periodo_2, diff_adj, upr_adj, lwr_adj, 'p adj')
view(interaction2)
interaction2 <- tukey %>%
pluck("ideologia:Periodo") %>% #selecciona el elemento de una lista
mutate(aux_ideol1 = str_match(Categories, pattern = "^(.*?):")[, 2],
aux_periodo1 = str_match(Categories, pattern = ":(.*?)-")[, 2],
aux_ideol2  = str_match(Categories, pattern = "-(.*?):")[, 2],
aux_periodo2= word(Categories, 3, sep = fixed(':')),
periodo_1 = if_else(as.numeric(aux_periodo1) <= as.numeric(aux_periodo2),
aux_periodo1, aux_periodo2) %>%
factor(levels = levels(pooled$Periodo))
)
interaction2 <- tukey %>%
pluck("ideologia:Periodo") %>% #selecciona el elemento de una lista
mutate(aux_ideol1 = str_match(Categories, pattern = "^(.*?):")[, 2],
aux_periodo1 = str_match(Categories, pattern = ":(.*?)-")[, 2],
aux_ideol2  = str_match(Categories, pattern = "-(.*?):")[, 2],
aux_periodo2= word(Categories, 3, sep = fixed(':'))
)
view(interaction2)
interaction2 <- tukey %>%
pluck("ideologia:Periodo") %>% #selecciona el elemento de una lista
mutate(aux_ideol1 = str_match(Categories, pattern = "^(.*?):")[, 2],
aux_periodo1 = str_match(Categories, pattern = ":(.*?)-")[, 2],
aux_ideol2  = str_match(Categories, pattern = "-(.*?):")[, 2],
aux_periodo2= word(Categories, 3, sep = fixed(':')),
periodo_1 = if_else(as.numeric(aux_periodo1) <= as.numeric(aux_periodo2),
aux_periodo1, aux_periodo2)
)
view(interaction2)
interaction2 <- tukey %>%
pluck("ideologia:Periodo") %>% #selecciona el elemento de una lista
mutate(aux_ideol1 = str_match(Categories, pattern = "^(.*?):")[, 2],
aux_periodo1 = str_match(Categories, pattern = ":(.*?)-")[, 2] %>%
factor(levels = levels(pooled$Periodo)),
aux_ideol2  = str_match(Categories, pattern = "-(.*?):")[, 2],
aux_periodo2= word(Categories, 3, sep = fixed(':')) %>%
factor(levels = levels(pooled$Periodo)),
periodo_1 = if_else(as.numeric(aux_periodo1) <= as.numeric(aux_periodo2),
aux_periodo1, aux_periodo2)
)
view(interaction2)
interaction2 <- tukey %>%
pluck("ideologia:Periodo") %>% #selecciona el elemento de una lista
mutate(aux_ideol1 = str_match(Categories, pattern = "^(.*?):")[, 2],
aux_periodo1 = str_match(Categories, pattern = ":(.*?)-")[, 2] %>%
factor(levels = levels(pooled$Periodo)),
aux_ideol2  = str_match(Categories, pattern = "-(.*?):")[, 2],
aux_periodo2= word(Categories, 3, sep = fixed(':')) %>%
factor(levels = levels(pooled$Periodo)),
periodo_1 = if_else(as.numeric(aux_periodo1) <= as.numeric(aux_periodo2),
aux_periodo1, aux_periodo2),
ubicacion_1 = if_else(aux_periodo1 == periodo_1,
if_else(periodo_1 != aux_periodo2,
aux_ideol1,
pmin(aux_ideol1, aux_ideol2)),
aux_ideol2)
)
view(interaction2)
interaction2 <- tukey %>%
pluck("ideologia:Periodo") %>% #selecciona el elemento de una lista
mutate(aux_ideol1 = str_match(Categories, pattern = "^(.*?):")[, 2],
aux_periodo1 = str_match(Categories, pattern = ":(.*?)-")[, 2] %>%
factor(levels = levels(pooled$Periodo)),
aux_ideol2  = str_match(Categories, pattern = "-(.*?):")[, 2],
aux_periodo2= word(Categories, 3, sep = fixed(':')) %>%
factor(levels = levels(pooled$Periodo)),
periodo_1 = if_else(as.numeric(aux_periodo1) <= as.numeric(aux_periodo2),
aux_periodo1, aux_periodo2),
ubicacion_1 = if_else(aux_periodo1 == periodo_1,
if_else(periodo_1 != aux_periodo2,
aux_ideol1,
pmin(aux_ideol1, aux_ideol2)),
aux_ideol2),
periodo_2 = if_else(aux_periodo1 == periodo_1, aux_periodo2, aux_periodo1),
ubicacion_2 = if_else(ubicacion_1 == aux_ideol1 & periodo_1 == aux_periodo1,
aux_ideol2,
aux_ideol1)
)
view(interaction2)
interaction2 <- tukey %>%
pluck("ideologia:Periodo") %>% #selecciona el elemento de una lista
mutate(aux_ideol1 = str_match(Categories, pattern = "^(.*?):")[, 2],
aux_periodo1 = str_match(Categories, pattern = ":(.*?)-")[, 2] %>%
factor(levels = levels(pooled$Periodo)),
aux_ideol2  = str_match(Categories, pattern = "-(.*?):")[, 2],
aux_periodo2= word(Categories, 3, sep = fixed(':')) %>%
factor(levels = levels(pooled$Periodo)),
periodo_1 = if_else(as.numeric(aux_periodo1) <= as.numeric(aux_periodo2),
aux_periodo1, aux_periodo2),
ubicacion_1 = if_else(aux_periodo1 == periodo_1,
if_else(periodo_1 != aux_periodo2,
aux_ideol1,
pmin(aux_ideol1, aux_ideol2)),
aux_ideol2),
periodo_2 = if_else(aux_periodo1 == periodo_1, aux_periodo2, aux_periodo1),
ubicacion_2 = if_else(ubicacion_1 == aux_ideol1 & periodo_1 == aux_periodo1,
aux_ideol2,
aux_ideol1),
diff_adj = if_else(aux_ideol1 == ubicacion_1 & aux_periodo1 == periodo_1, diff, -1*diff),
upr_adj = diff_adj + abs((upr - lwr) / 2),
lwr_adj = diff_adj - abs((upr - lwr) / 2)
)
view(interaction2)
"1"<"2"
"3"<"6"
"3">"20"
interaction2 <- tukey %>%
pluck("ideologia:Periodo") %>% #selecciona el elemento de una lista
mutate(aux_ideol1 = str_match(Categories, pattern = "^(.*?):")[, 2] %>% as.numeric(),
aux_periodo1 = str_match(Categories, pattern = ":(.*?)-")[, 2] %>%
factor(levels = levels(pooled$Periodo)),
aux_ideol2  = str_match(Categories, pattern = "-(.*?):")[, 2] %>% as.numeric(),
aux_periodo2= word(Categories, 3, sep = fixed(':')) %>%
factor(levels = levels(pooled$Periodo)),
periodo_1 = if_else(as.numeric(aux_periodo1) <= as.numeric(aux_periodo2),
aux_periodo1, aux_periodo2),
ubicacion_1 = if_else(aux_periodo1 == periodo_1,
if_else(aux_periodo1 == aux_periodo2,
pmin(aux_ideol1, aux_ideol2),
aux_ideol1),
aux_ideol2),
periodo_2 = if_else(aux_periodo1 == periodo_1, aux_periodo2, aux_periodo1),
ubicacion_2 = if_else(ubicacion_1 == aux_ideol1,
aux_ideol2,
aux_ideol1),
diff_adj = if_else(aux_ideol1 == ubicacion_1 & aux_periodo1 == periodo_1, diff, -1*diff),
upr_adj = diff_adj + abs((upr - lwr) / 2),
lwr_adj = diff_adj - abs((upr - lwr) / 2)
)
view(interaction2)
interaction2[with(interaction2, diff==diff_adj), ]
interaction2[with(interaction2, diff== abs(diff_adj)), ]
nrow(interaction2)
nrow(interaction2[with(interaction2, diff==diff_adj), ])
nrow(interaction2[with(interaction2, diff==-diff_adj), ])
interaction2 <- tukey %>%
pluck("ideologia:Periodo") %>% #selecciona el elemento de una lista
mutate(aux_ideol1 = str_match(Categories, pattern = "^(.*?):")[, 2] %>% as.numeric(),
aux_periodo1 = str_match(Categories, pattern = ":(.*?)-")[, 2] %>%
factor(levels = levels(pooled$Periodo)),
aux_ideol2  = str_match(Categories, pattern = "-(.*?):")[, 2] %>% as.numeric(),
aux_periodo2= word(Categories, 3, sep = fixed(':')) %>%
factor(levels = levels(pooled$Periodo)),
periodo_1 = if_else(as.numeric(aux_periodo1) <= as.numeric(aux_periodo2),
aux_periodo1, aux_periodo2),
ubicacion_1 = if_else(aux_periodo1 == periodo_1,
if_else(aux_periodo1 == aux_periodo2,
pmin(aux_ideol1, aux_ideol2),
aux_ideol1),
aux_ideol2),
periodo_2 = if_else(aux_periodo1 == periodo_1, aux_periodo2, aux_periodo1),
ubicacion_2 = if_else(ubicacion_1 == aux_ideol1,
aux_ideol2,
aux_ideol1),
diff_adj = if_else(aux_ideol1 != ubicacion_1 | aux_periodo1 != periodo_1, -1*diff, diff),
upr_adj = diff_adj + abs((upr - lwr) / 2),
lwr_adj = diff_adj - abs((upr - lwr) / 2)
)
view(interaction2)
view(interaction2 %>% select(Categories, diff, periodo_1, ubicacion_1, periodo_2, ubicacion_2, diff_adj))
interaction2 <- tukey %>%
pluck("ideologia:Periodo") %>% #selecciona el elemento de una lista
mutate(aux_ideol1 = str_match(Categories, pattern = "^(.*?):")[, 2] %>% as.numeric(),
aux_periodo1 = str_match(Categories, pattern = ":(.*?)-")[, 2] %>%
factor(levels = levels(pooled$Periodo)),
aux_ideol2  = str_match(Categories, pattern = "-(.*?):")[, 2] %>% as.numeric(),
aux_periodo2= word(Categories, 3, sep = fixed(':')) %>%
factor(levels = levels(pooled$Periodo)),
periodo_1 = if_else(as.numeric(aux_periodo1) <= as.numeric(aux_periodo2),
aux_periodo1, aux_periodo2),
ubicacion_1 = if_else(aux_periodo1 == periodo_1,
if_else(aux_periodo1 == aux_periodo2,
pmin(aux_ideol1, aux_ideol2),
aux_ideol1),
aux_ideol2),
periodo_2 = if_else(aux_periodo1 == periodo_1, aux_periodo2, aux_periodo1),
ubicacion_2 = if_else(ubicacion_1 == aux_ideol1,
aux_ideol2,
aux_ideol1),
diff_adj = if_else(aux_ideol1 != ubicacion_1 | aux_periodo1 != periodo_1, -1*diff, diff),
upr_adj = diff_adj + abs((upr - lwr) / 2),
lwr_adj = diff_adj - abs((upr - lwr) / 2)
) %>%
arrange(ubicacion_1, periodo_1, periodo_2, ubicacion_2)
interaction2 <- tukey %>%
pluck("ideologia:Periodo") %>% #selecciona el elemento de una lista
mutate(aux_ideol1 = str_match(Categories, pattern = "^(.*?):")[, 2] %>% as.numeric(),
aux_periodo1 = str_match(Categories, pattern = ":(.*?)-")[, 2] %>%
factor(levels = levels(pooled$Periodo)),
aux_ideol2  = str_match(Categories, pattern = "-(.*?):")[, 2] %>% as.numeric(),
aux_periodo2= word(Categories, 3, sep = fixed(':')) %>%
factor(levels = levels(pooled$Periodo)),
periodo_1 = if_else(as.numeric(aux_periodo1) <= as.numeric(aux_periodo2),
aux_periodo1, aux_periodo2),
ubicacion_1 = if_else(aux_periodo1 == periodo_1,
if_else(aux_periodo1 == aux_periodo2,
pmin(aux_ideol1, aux_ideol2),
aux_ideol1),
aux_ideol2),
periodo_2 = if_else(aux_periodo1 == periodo_1, aux_periodo2, aux_periodo1),
ubicacion_2 = if_else(ubicacion_1 == aux_ideol1,
aux_ideol2,
aux_ideol1),
diff_adj = if_else(aux_ideol1 != ubicacion_1 | aux_periodo1 != periodo_1, -1*diff, diff),
upr_adj = diff_adj + abs((upr - lwr) / 2),
lwr_adj = diff_adj - abs((upr - lwr) / 2)
) %>%
arrange(ubicacion_1, periodo_1, periodo_2, ubicacion_2) %>%
select(ubicacion_1, periodo_1, ubicacion_2, periodo_2, diff_adj, upr_adj, lwr_adj, 'p adj')
view(interaction2)
mainfx_ideologia <- tukey %>%
pluck("ideologia")
mainfx_ideologia
