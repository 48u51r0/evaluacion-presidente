#panel.grid.major = element_line(colour = "lightgrey",
#                                size = .15),
panel.grid.major = element_blank(),
strip.background = element_rect(color = "black",
fill = "white",
size = 1,
linetype = "solid"),
strip.text.x = element_text(size = 12,
face = "bold"),
axis.title=element_text(size=14)
)+
coord_fixed(ratio = 1)
Completo %>% ggpredict(c("ideol_GMC[all]", "RV"),
vcov.fun = "vcovHC",
vcov.type = "HC0") %>%
filter(!group %in% c("Otros", "MP", "Cs", "Vox")) %>%
mutate(group = fct_drop(group)) %>%
ggplot(aes(x=x,
y=predicted,
group = group)) +
geom_line() +
geom_ribbon(aes(ymin = conf.low,
ymax = conf.high),
alpha = .3,
colour = NA) +
guides(color = FALSE,
size = FALSE) +
theme(legend.title = element_blank()) +
#geom_vline(xintercept =0, linetype = "dashed", alpha = .5)+
geom_point(x = 0, aes(y=predicted, group = group))+
facet_grid(~group) +
labs(x = "Autoubicación ideológica centrada en la media del periodo",
y = "Valoración Presidente (1-10)") +
theme(legend.background = element_rect(fill = "white",
colour = NA),
panel.background = element_blank(),
panel.border =element_rect(colour = "black",
fill = NA,
size = 1),
#panel.grid.major = element_line(colour = "lightgrey",
#                                size = .15),
panel.grid.major = element_blank(),
strip.background = element_rect(color = "black",
fill = "white",
size = 1,
linetype = "solid"),
strip.text.x = element_text(size = 12,
face = "bold"),
axis.title=element_text(size=14)
)+
coord_fixed(ratio = 1)
Completo %>% ggpredict(c("ideol_GMC[all]", "RV"),
vcov.fun = "vcovHC",
vcov.type = "HC0") %>%
filter(!group %in% c("Otros", "MP", "Cs", "Vox")) %>%
mutate(group = fct_drop(group)) %>%
ggplot(aes(x=x,
y=predicted,
group = group)) +
geom_line() +
geom_ribbon(aes(ymin = conf.low,
ymax = conf.high),
alpha = .3,
colour = NA) +
guides(color = FALSE,
size = FALSE) +
theme(legend.title = element_blank()) +
#geom_vline(xintercept =0, linetype = "dashed", alpha = .5)+
geom_point(x = 0, aes(y=predicted, group = group))+
facet_wrap(~group) +
labs(x = "Autoubicación ideológica centrada en la media del periodo",
y = "Valoración Presidente (1-10)") +
theme(legend.background = element_rect(fill = "white",
colour = NA),
panel.background = element_blank(),
panel.border =element_rect(colour = "black",
fill = NA,
size = 1),
#panel.grid.major = element_line(colour = "lightgrey",
#                                size = .15),
panel.grid.major = element_blank(),
strip.background = element_rect(color = "black",
fill = "white",
size = 1,
linetype = "solid"),
strip.text.x = element_text(size = 12,
face = "bold"),
axis.title=element_text(size=14)
)+
coord_fixed(ratio = 1)
Completo %>% ggpredict(c("ideol_GMC[all]", "RV"),
vcov.fun = "vcovHC",
vcov.type = "HC0") %>%
filter(!group %in% c("Otros", "MP", "Cs", "Vox")) %>%
mutate(group = fct_drop(group)) %>%
ggplot(aes(x=x,
y=predicted,
group = group)) +
geom_line() +
geom_ribbon(aes(ymin = conf.low,
ymax = conf.high),
alpha = .3,
colour = NA) +
guides(color = FALSE,
size = FALSE) +
theme(legend.title = element_blank()) +
facet_wrap(~group) +
labs(x = "Autoubicación ideológica centrada en la media del periodo",
y = "Valoración Presidente (1-10)") +
theme(legend.background = element_rect(fill = "white",
colour = NA),
panel.background = element_blank(),
panel.border =element_rect(colour = "black",
fill = NA,
size = 1),
#panel.grid.major = element_line(colour = "lightgrey",
#                                size = .15),
panel.grid.major = element_blank(),
strip.background = element_rect(color = "black",
fill = "white",
size = 1,
linetype = "solid"),
strip.text.x = element_text(size = 12,
face = "bold"),
axis.title=element_text(size=14)
)+
coord_fixed(ratio = 1)
Completo %>% ggpredict(c("ideol_GMC[all]", "RV"),
vcov.fun = "vcovHC",
vcov.type = "HC0") %>%
filter(!group %in% c("Otros", "MP", "Cs", "Vox")) %>%
mutate(group = fct_drop(group)) %>%
ggplot(aes(x=x,
y=predicted,
group = group)) +
geom_line() +
geom_ribbon(aes(ymin = conf.low,
ymax = conf.high),
alpha = .3,
colour = NA) +
guides(color = FALSE,
size = FALSE) +
theme(legend.title = element_blank()) +
facet_wrap(~group) +
labs(x = "Autoubicación ideológica centrada en la media del periodo",
y = "Valoración Presidente (1-10)") +
theme(legend.background = element_rect(fill = "white",
colour = NA),
panel.background = element_blank(),
panel.border =element_rect(colour = "black",
fill = NA,
size = 1),
#panel.grid.major = element_line(colour = "lightgrey",
#                                size = .15),
panel.grid.major = element_blank(),
strip.background = element_rect(color = "black",
fill = "white",
size = 1,
linetype = "solid"),
strip.text.x = element_text(size = 12,
face = "bold"),
axis.title=element_text(size=14)
)
Completo %>% ggpredict(c("ideol_GMC[all]", "RV"),
vcov.fun = "vcovHC",
vcov.type = "HC0") %>%
filter(!group %in% c("Otros", "MP", "Cs", "Vox")) %>%
mutate(group = fct_drop(group)) %>%
ggplot(aes(x=x,
y=predicted,
group = group)) +
geom_line() +
geom_ribbon(aes(ymin = conf.low,
ymax = conf.high),
alpha = .3,
colour = NA) +
guides(color = FALSE,
size = FALSE) +
theme(legend.title = element_blank()) +
facet_wrap(~group) +
labs(x = "Autoubicación ideológica centrada en la media",
y = "Valoración Presidente (1-10)") +
theme(legend.background = element_rect(fill = "white",
colour = NA),
panel.background = element_blank(),
panel.border =element_rect(colour = "black",
fill = NA,
size = 1),
#panel.grid.major = element_line(colour = "lightgrey",
#                                size = .15),
panel.grid.major = element_blank(),
strip.background = element_rect(color = "black",
fill = "white",
size = 1,
linetype = "solid"),
strip.text.x = element_text(size = 12,
face = "bold"),
axis.title=element_text(size=14)
)
Completo2 <- lm(eval_pres ~ RV*ns(ideol_GMC, 3) + man+higher_educ+welloff,
data = df_3277,
weights = PESO)
completo2 <- coeftest(Completo2, vcov. = vcovHC(Completo2, type = "HC0"))
Completo2 %>% ggpredict(c("ideol_GMC[all]", "RV"),
vcov.fun = "vcovHC",
vcov.type = "HC0") %>%
filter(!group %in% c("Otros", "MP", "Cs", "Vox")) %>%
mutate(group = fct_drop(group)) %>%
ggplot(aes(x=x,
y=predicted,
group = group)) +
geom_line() +
geom_ribbon(aes(ymin = conf.low,
ymax = conf.high),
alpha = .3,
colour = NA) +
guides(color = FALSE,
size = FALSE) +
theme(legend.title = element_blank()) +
facet_wrap(~group) +
labs(x = "Autoubicación ideológica centrada en la media",
y = "Valoración Presidente (1-10)") +
theme(legend.background = element_rect(fill = "white",
colour = NA),
panel.background = element_blank(),
panel.border =element_rect(colour = "black",
fill = NA,
size = 1),
#panel.grid.major = element_line(colour = "lightgrey",
#                                size = .15),
panel.grid.major = element_blank(),
strip.background = element_rect(color = "black",
fill = "white",
size = 1,
linetype = "solid"),
strip.text.x = element_text(size = 12,
face = "bold"),
axis.title=element_text(size=14)
)+
coord_fixed(ratio = 1)
Completo2 %>% ggpredict(c("ideol_GMC[all]", "RV"),
vcov.fun = "vcovHC",
vcov.type = "HC0") %>%
filter(!group %in% c("Otros", "MP", "Cs", "Vox")) %>%
mutate(group = fct_drop(group)) %>%
ggplot(aes(x=x,
y=predicted,
group = group)) +
geom_line() +
geom_ribbon(aes(ymin = conf.low,
ymax = conf.high),
alpha = .3,
colour = NA) +
guides(color = FALSE,
size = FALSE) +
theme(legend.title = element_blank()) +
facet_wrap(~group) +
labs(x = "Autoubicación ideológica centrada en la media",
y = "Valoración Presidente (1-10)") +
theme(legend.background = element_rect(fill = "white",
colour = NA),
panel.background = element_blank(),
panel.border =element_rect(colour = "black",
fill = NA,
size = 1),
#panel.grid.major = element_line(colour = "lightgrey",
#                                size = .15),
panel.grid.major = element_blank(),
strip.background = element_rect(color = "black",
fill = "white",
size = 1,
linetype = "solid"),
strip.text.x = element_text(size = 12,
face = "bold"),
axis.title=element_text(size=14)
)+
coord_fixed(ratio = 1)+
ylim(0,10)
Completo2 <- lm(eval_pres ~ RV*bs(ideol_GMC, 3) + man+higher_educ+welloff,
data = df_3277,
weights = PESO)
Completo2 %>% ggpredict(c("ideol_GMC[all]", "RV"),
vcov.fun = "vcovHC",
vcov.type = "HC0") %>%
filter(!group %in% c("Otros", "MP", "Cs", "Vox")) %>%
mutate(group = fct_drop(group)) %>%
ggplot(aes(x=x,
y=predicted,
group = group)) +
geom_line() +
geom_ribbon(aes(ymin = conf.low,
ymax = conf.high),
alpha = .3,
colour = NA) +
guides(color = FALSE,
size = FALSE) +
theme(legend.title = element_blank()) +
facet_wrap(~group) +
labs(x = "Autoubicación ideológica centrada en la media",
y = "Valoración Presidente (1-10)") +
theme(legend.background = element_rect(fill = "white",
colour = NA),
panel.background = element_blank(),
panel.border =element_rect(colour = "black",
fill = NA,
size = 1),
#panel.grid.major = element_line(colour = "lightgrey",
#                                size = .15),
panel.grid.major = element_blank(),
strip.background = element_rect(color = "black",
fill = "white",
size = 1,
linetype = "solid"),
strip.text.x = element_text(size = 12,
face = "bold"),
axis.title=element_text(size=14)
)+
coord_fixed(ratio = 1)
Completo2 <- lm(eval_pres ~ RV*ns(ideol_GMC, 3) + man+higher_educ+welloff,
data = df_3277,
weights = PESO)
Completo2 %>% ggpredict(c("ideol_GMC[all]", "RV"),
vcov.fun = "vcovHC",
vcov.type = "HC0") %>%
filter(!group %in% c("Otros", "MP", "Cs", "Vox")) %>%
mutate(group = fct_drop(group)) %>%
ggplot(aes(x=x,
y=predicted,
group = group)) +
geom_line() +
geom_ribbon(aes(ymin = conf.low,
ymax = conf.high),
alpha = .3,
colour = NA) +
guides(color = FALSE,
size = FALSE) +
theme(legend.title = element_blank()) +
facet_wrap(~group) +
labs(x = "Autoubicación ideológica centrada en la media",
y = "Valoración Presidente (1-10)") +
theme(legend.background = element_rect(fill = "white",
colour = NA),
panel.background = element_blank(),
panel.border =element_rect(colour = "black",
fill = NA,
size = 1),
#panel.grid.major = element_line(colour = "lightgrey",
#                                size = .15),
panel.grid.major = element_blank(),
strip.background = element_rect(color = "black",
fill = "white",
size = 1,
linetype = "solid"),
strip.text.x = element_text(size = 12,
face = "bold"),
axis.title=element_text(size=14)
)+
coord_fixed(ratio = 1)+
ylim(0,10)
Completo2 <- lm(eval_pres ~ RV*poly(ideol_GMC, 3) + man+higher_educ+welloff,
data = df_3277,
weights = PESO)
Completo2 %>% ggpredict(c("ideol_GMC[all]", "RV"),
vcov.fun = "vcovHC",
vcov.type = "HC0") %>%
filter(!group %in% c("Otros", "MP", "Cs", "Vox")) %>%
mutate(group = fct_drop(group)) %>%
ggplot(aes(x=x,
y=predicted,
group = group)) +
geom_line() +
geom_ribbon(aes(ymin = conf.low,
ymax = conf.high),
alpha = .3,
colour = NA) +
guides(color = FALSE,
size = FALSE) +
theme(legend.title = element_blank()) +
facet_wrap(~group) +
labs(x = "Autoubicación ideológica centrada en la media",
y = "Valoración Presidente (1-10)") +
theme(legend.background = element_rect(fill = "white",
colour = NA),
panel.background = element_blank(),
panel.border =element_rect(colour = "black",
fill = NA,
size = 1),
#panel.grid.major = element_line(colour = "lightgrey",
#                                size = .15),
panel.grid.major = element_blank(),
strip.background = element_rect(color = "black",
fill = "white",
size = 1,
linetype = "solid"),
strip.text.x = element_text(size = 12,
face = "bold"),
axis.title=element_text(size=14)
)+
coord_fixed(ratio = 1)
Completo2 %>% ggpredict(c("ideol_GMC[all]", "RV"),
vcov.fun = "vcovHC",
vcov.type = "HC0") %>%
filter(!group %in% c("Otros", "MP", "Cs", "Vox")) %>%
mutate(group = fct_drop(group)) %>%
ggplot(aes(x=x,
y=predicted,
group = group)) +
geom_line() +
geom_ribbon(aes(ymin = conf.low,
ymax = conf.high),
alpha = .3,
colour = NA) +
guides(color = FALSE,
size = FALSE) +
theme(legend.title = element_blank()) +
facet_wrap(~group) +
labs(x = "Autoubicación ideológica centrada en la media",
y = "Valoración Presidente (1-10)") +
theme(legend.background = element_rect(fill = "white",
colour = NA),
panel.background = element_blank(),
panel.border =element_rect(colour = "black",
fill = NA,
size = 1),
#panel.grid.major = element_line(colour = "lightgrey",
#                                size = .15),
panel.grid.major = element_blank(),
strip.background = element_rect(color = "black",
fill = "white",
size = 1,
linetype = "solid"),
strip.text.x = element_text(size = 12,
face = "bold"),
axis.title=element_text(size=14)
)+
coord_fixed(ratio = 1)+
ylim(0,10)
Completo %>% ggpredict(c("ideol_GMC[all]", "RV"),
vcov.fun = "vcovHC",
vcov.type = "HC0") %>%
filter(!group %in% c("Otros", "MP", "Cs", "Vox")) %>%
mutate(group = fct_drop(group)) %>%
ggplot(aes(x=x,
y=predicted,
group = group)) +
geom_line() +
geom_ribbon(aes(ymin = conf.low,
ymax = conf.high),
alpha = .3,
colour = NA) +
guides(color = FALSE,
size = FALSE) +
theme(legend.title = element_blank()) +
facet_wrap(~group) +
labs(x = "Autoubicación ideológica centrada en la media",
y = "Valoración Presidente (1-10)") +
theme(legend.background = element_rect(fill = "white",
colour = NA),
panel.background = element_blank(),
panel.border =element_rect(colour = "black",
fill = NA,
size = 1),
#panel.grid.major = element_line(colour = "lightgrey",
#                                size = .15),
panel.grid.major = element_blank(),
strip.background = element_rect(color = "black",
fill = "white",
size = 1,
linetype = "solid"),
strip.text.x = element_text(size = 12,
face = "bold"),
axis.title=element_text(size=14)
)+
coord_fixed(ratio = 1)+
ylim(0,10)
Completo %>% ggpredict(c("ideol_GMC[all]", "RV"),
vcov.fun = "vcovHC",
vcov.type = "HC0") %>%
filter(!group %in% c("Otros", "MP", "Cs", "Vox")) %>%
mutate(group = fct_drop(group)) %>%
ggplot(aes(x=x,
y=predicted,
group = group)) +
geom_line() +
geom_ribbon(aes(ymin = conf.low,
ymax = conf.high),
alpha = .3,
colour = NA) +
guides(color = FALSE,
size = FALSE) +
theme(legend.title = element_blank()) +
facet_wrap(~group) +
labs(x = "Autoubicación ideológica centrada en la media",
y = "Valoración Presidente (1-10)") +
theme(legend.background = element_rect(fill = "white",
colour = NA),
panel.background = element_blank(),
panel.border =element_rect(colour = "black",
fill = NA,
size = 1),
#panel.grid.major = element_line(colour = "lightgrey",
#                                size = .15),
panel.grid.major = element_blank(),
strip.background = element_rect(color = "black",
fill = "white",
size = 1,
linetype = "solid"),
strip.text.x = element_text(size = 12,
face = "bold"),
axis.title=element_text(size=14)
)+
coord_fixed(ratio = 1)
