relevel(2),
eval_pres = case_when(as.numeric(P33_1)  %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(P33_1)),
evalpres_GMC = eval_pres - mean(eval_pres, na.rm = TRUE),
P33_2 = case_when(as.numeric(P33_2) %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(P33_2)),
P33_3 = case_when(as.numeric(P33_3) %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(P33_3)),
P33_4 = case_when(as.numeric(P33_4) %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(P33_4)),
P33_5 = case_when(as.numeric(P33_5) %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(P33_5)),
eval_opos = pmax(P33_2, P33_3, P33_4, P33_5, na.rm = TRUE),
ideol_pers = case_when(as.numeric(ESCIDEOL)  %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(ESCIDEOL)),
ideolpers_GMC = ideol_pers - mean(ideol_pers, na.rm = TRUE),
ideol_pres = case_when(as.numeric(ESCIDEOLPOLI_1)  %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(ESCIDEOLPOLI_1)),
dist_ideo = ideol_pers - ideol_pres,
distideo_GMC= dist_ideo - mean(dist_ideo, na.rm = TRUE),
dist_eval = eval_pres - eval_opos,
ideol_2 = ideolpers_GMC^2,
ideol_3 = ideolpers_GMC^3,
distideo_2 = distideo_GMC^2,
distideo_3 = distideo_GMC^3,
man = case_when(SEXO == 1 ~ 1L,
SEXO == 2 ~ 0L,
TRUE ~ NA_integer_) %>%
factor(levels = c(0, 1),
labels = c("Mujer", "Hombre")
) %>%
relevel(1),
higher_educ = case_when(NIVELESTENTREV %in% c(1:8, 17) ~ 0L,
NIVELESTENTREV %in% 9:16 ~ 1L,
TRUE ~ NA_integer_) %>%
factor(levels = c(0, 1),
labels = c("Universitario", "No-Universitario")
) %>%
relevel(1),
welloff = case_when(CLASESOCIAL %in% 1:3 ~ 1L, #high, middle-high, middle-middle
CLASESOCIAL %in% 4:11 ~ 0L,
TRUE ~ NA_integer_) %>%
factor(levels = c(0, 1),
labels = c("Medio-alto", "Bajo")
) %>%
relevel(1)
) %>%
select(id, Periodo, dist_eval, eval_pres, evalpres_GMC, eval_opos, ideol_pers,ideolpers_GMC, ideol_2, ideol_3, distideo_GMC, distideo_2, distideo_3, RV, man, higher_educ, welloff, PESO) %>%
drop_na() %>%
write_rds("df_3281.rds")
rm(list = ls())
ggplot(pooled_aov, aes(y = eval_pres, x = ideologia))+
stat_summary(fun=mean,geom="point",aes(group= Periodo,colour=Periodo))+
stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = .1, aes(group= Periodo,colour=Periodo))+
stat_summary(fun = mean, geom = "line",aes(group= Periodo,colour=Periodo)) +
labs(x = "Autoubicación ideológica (1-10)", y = "Valoración del presidente (1-10)")
df_3269 <- read_rds("df_3269.rds")
df_3271 <- read_rds("df_3271.rds")
df_3273 <- read_rds("df_3273.rds")
df_3277 <- read_rds("df_3277.rds")
df_3279 <- read_rds("df_3279.rds")
df_3281 <- read_rds("df_3281.rds")
#------------------Generate pooled data---------------------------------------
pooled_aov <- bind_rows(df_3269, df_3271, df_3273, df_3277, df_3279, df_3281) %>%
mutate(Periodo = factor(Periodo, levels = 1:5,
labels = c("Poselectoral", "Enero", "Febrero", "Marzo",
"Abril", "Mayo")
),
ideologia = factor(ideol_pers, levels = 1:10)
)
#--------------------Visualise means with errorbars--------------------------------
ggplot(pooled_aov, aes(y = eval_pres, x = ideologia))+
stat_summary(fun=mean,geom="point",aes(group= Periodo,colour=Periodo))+
stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = .1, aes(group= Periodo,colour=Periodo))+
stat_summary(fun = mean, geom = "line",aes(group= Periodo,colour=Periodo)) +
labs(x = "Autoubicación ideológica (1-10)", y = "Valoración del presidente (1-10)")
pooled_aov <- bind_rows(df_3269, df_3271, df_3273, df_3277, df_3279, df_3281) %>%
mutate(Periodo = factor(Periodo, levels = 1:6,
labels = c("Poselectoral", "Enero", "Febrero", "Marzo",
"Abril", "Mayo")
),
ideologia = factor(ideol_pers, levels = 1:10)
)
ggplot(pooled_aov, aes(y = eval_pres, x = ideologia))+
stat_summary(fun=mean,geom="point",aes(group= Periodo,colour=Periodo))+
stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = .1, aes(group= Periodo,colour=Periodo))+
stat_summary(fun = mean, geom = "line",aes(group= Periodo,colour=Periodo)) +
labs(x = "Autoubicación ideológica (1-10)", y = "Valoración del presidente (1-10)")
backup_3279 <- readRDS("C:/Users/natal/Desktop/Paper_08042020/backup_3279.rds")
sjlabelled::get_label(backup_3279$INTENCIONG)
sjlabelled::get_labels(backup_3279$INTENCIONG)
xtable::xtable(backup_3279$INTENCIONG)
table(backup_3279$INTENCIONG)
a <- table(backup_3279$INTENCIONG)
class(a)
attr(a)
attributes(a)
names(a) <- sjlabelled::get_labels(backup_3279$INTENCIONG)
dimnames(a)
dimnames(a) <- sjlabelled::get_labels(backup_3279$INTENCIONG)
list(sjlabelled::get_labels(backup_3279$INTENCIONG))
dimnames(a) <- list(sjlabelled::get_labels(backup_3279$INTENCIONG))
length(dimnames(a))
length(unlist(dimnames(a)))
length(sjlabelled::get_labels(backup_3279$INTENCIONG))
unlist(dimnames(a))
sjlabelled::get_labels(backup_3279$INTENCIONG)
a <- table(backup_3279$INTENCIONG, exclude = "always")
a
a <- table(backup_3279$INTENCIONG, exclude = "ifany")
a
length(unlist(dimnames(a)))
pooled_aov <- bind_rows(df_3273, df_3277, df_3279, df_3281) %>%
mutate(Periodo = factor(Periodo, levels = 3:6,
labels = c("Febrero", "Marzo",
"Abril", "Mayo")
),
ideologia = factor(ideol_pers, levels = 1:10)
)
install_pack <- function(pkg){
new.pkg <- pkg[!(pkg %in% installed.packages()[, "Package"])]
if (length(new.pkg))
install.packages(new.pkg, dependencies = TRUE)
sapply(pkg, library, character.only = TRUE)
}
packages <- (c("haven", "sandwich", "multcomp", "emmeans", "tidyverse", "conflicted"))
install_pack(packages)
# resolvemos los conflictos de funciones entre dplyr y MASS
conflict_prefer("select", "dplyr")
conflict_prefer("filter", "dplyr")
rm("packages", "install_pack")
pooled_aov <- bind_rows(df_3273, df_3277, df_3279, df_3281) %>%
mutate(Periodo = factor(Periodo, levels = 3:6,
labels = c("Febrero", "Marzo",
"Abril", "Mayo")
),
ideologia = factor(ideol_pers, levels = 1:10)
)
pooled_aov <- bind_rows(df_3271, df_3273, df_3277, df_3279, df_3281) %>%
mutate(Periodo = factor(Periodo, levels = 2:6,
labels = c("Enero", "Febrero", "Marzo",
"Abril", "Mayo")
),
ideologia = factor(ideol_pers, levels = 1:10)
)
#grafico sin ponderar
ggplot(pooled_aov, aes(y = eval_pres, x = ideologia))+
stat_summary(fun=mean,geom="point",aes(group= Periodo,colour=Periodo))+
stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = .1, aes(group= Periodo,colour=Periodo))+
stat_summary(fun = mean, geom = "line",aes(group= Periodo,colour=Periodo)) +
labs(x = "Autoubicación ideológica (1-10)", y = "Valoración del presidente (1-10)")
#grafico con ponderación
pooled_aov %>%
group_by(ideologia, Periodo) %>%
summarise(media = Hmisc::wtd.mean(eval_pres, PESO),
se =sqrt(Hmisc::wtd.var(eval_pres, PESO)) / sqrt(n()),
uppr = media + 1.96 * se,
lwr = media - 1.96 * se) %>%
ggplot(aes(x = ideologia, y = media, group = Periodo, color = Periodo)) +
geom_line() +
geom_point() +
geom_errorbar(aes(ymin=lwr, ymax=uppr, width = .1)) +
labs(x = "Autoubicación ideológica (1-10)", y = "Valoración del presidente (1-10)")
mod_int <- lm(eval_pres ~ ideologia * Periodo, data=pooled_aov, weights = PESO)
mod_ad <- lm(eval_pres ~ ideologia + Periodo, data=pooled_aov, weights = PESO)
fit_int <- aov(mod_int)
fit_ad <- aov(mod_ad)
tukey_glht_sw_int <- glht(model = mod_int,
linfct = lsm(pairwise ~ ideologia:Periodo),
by = NULL,
vcov = sandwich)
tukey_glht_sw_ideologia <- glht(model = mod_ad,
linfct = mcp(ideologia = "Tukey"),
by = NULL,
vcov = sandwich)
tukey_glht_sw_Periodo <- glht(model = mod_ad,
linfct = mcp(Periodo = "Tukey"),
by = NULL,
vcov = sandwich)
intervals_glht_sw_int <- confint(tukey_glht_sw_int)$confint %>%
as.data.frame() %>%
rownames_to_column()
intervals_glht_sw_periodo <- confint(tukey_glht_sw_Periodo)$confint %>%
as.data.frame() %>%
rownames_to_column()
intervals_glht_sw_ideologia <- confint(tukey_glht_sw_ideologia)$confint %>%
as.data.frame() %>%
rownames_to_column()
interaction_glht_sw <- summary(tukey_glht_sw_int) %>%
broom::tidy() %>%
inner_join(intervals_glht_sw_int, by = c("lhs" = "rowname")) %>%
select(lhs, Estimate, lwr, upr, p.value) %>%
write_rds("interaction_glht_sw.rds")
interaction_adj <- interaction_glht_sw %>%
mutate(aux_ideol1 = str_match(lhs, pattern = "^(.*?),")[, 2] %>% as.numeric(),
aux_periodo1 = str_match(lhs, pattern = ",(.*?) - ")[, 2] %>%
factor(levels = levels(pooled_aov$Periodo)),
aux_ideol2  = str_match(lhs, pattern = "- (.*?),")[, 2] %>% as.numeric(),
aux_periodo2= word(lhs, 3, sep = fixed(',')) %>%
factor(levels = levels(pooled_aov$Periodo)),
periodo_1 = if_else(as.numeric(aux_periodo1) <= as.numeric(aux_periodo2),
aux_periodo1, aux_periodo2),
ubicacion_1 = if_else(aux_periodo1 == periodo_1,
if_else(aux_periodo1 == aux_periodo2,
pmin(aux_ideol1, aux_ideol2),
aux_ideol1),
aux_ideol2),
periodo_2 = if_else(aux_periodo1 == periodo_1, aux_periodo2, aux_periodo1),
ubicacion_2 = if_else(ubicacion_1 == aux_ideol1,
aux_ideol2,
aux_ideol1),
Estimate_adj = if_else(aux_ideol1 != ubicacion_1 | aux_periodo1 != periodo_1, -1*Estimate, Estimate),
upr_adj = Estimate_adj + abs((upr - lwr) / 2),
lwr_adj = Estimate_adj - abs((upr - lwr) / 2)
) %>%
arrange(ubicacion_1, periodo_1, periodo_2, ubicacion_2) %>%
select(ubicacion_1, periodo_1, ubicacion_2, periodo_2, Estimate_adj, upr_adj, lwr_adj, p.value)
# Se producen diferencias, entre usar sandwich o no. Hay más diferencias significativas al usarlo.
#A partir de ahora todas las inferencias las hacemos mediante sw
mainfx_Periodo_glht_sw <- summary(tukey_glht_sw_Periodo) %>%
broom::tidy() %>%
inner_join(intervals_glht_sw_periodo, by = c("lhs" = "rowname")) %>%
select(lhs, Estimate, lwr, upr, p.value) %>%
write_rds("mainfx_Periodo_glht_sw.rds")
mainfx_Periodo_adj <- mainfx_Periodo_glht_sw %>%
mutate(aux_periodo1 = str_match(lhs, pattern = "^(.*?) -")[, 2] %>%
factor(levels = levels(pooled_aov$Periodo)),
aux_periodo2 = str_match(lhs, pattern = "- (.*?)$")[, 2] %>%
factor(levels = levels(pooled_aov$Periodo)),
periodo_1 = if_else(as.numeric(aux_periodo1) <= as.numeric(aux_periodo2),
aux_periodo1, aux_periodo2),
periodo_2 = if_else(aux_periodo1 == periodo_1, aux_periodo2, aux_periodo1),
Estimate_adj = if_else(periodo_1 == aux_periodo1, Estimate, -1*Estimate),
upr_adj = Estimate_adj + abs((upr - lwr) / 2),
lwr_adj = Estimate_adj - abs((upr - lwr) / 2)
) %>%
arrange(periodo_1, periodo_2) %>%
select(periodo_1, periodo_2, Estimate_adj, upr_adj, lwr_adj, p.value)
mainfx_ideologia_glht_sw <- summary(tukey_glht_sw_ideologia) %>%
broom::tidy() %>%
inner_join(intervals_glht_sw_ideologia, by = c("lhs" = "rowname")) %>%
select(lhs, Estimate, lwr, upr, p.value) %>%
write_rds("mainfx_ideologia_glht_sw.rds")
mainfx_ideologia_adj <- mainfx_ideologia_glht_sw %>%
mutate(aux_ideol1 = str_match(lhs, pattern = "^(.*?) -")[, 2] %>% as.numeric(),
aux_ideol2 = str_match(lhs, pattern = "- (.*?)$")[, 2] %>% as.numeric(),
ubicacion_1 = pmin(aux_ideol1, aux_ideol2),
ubicacion_2 = pmax(aux_ideol1, aux_ideol2),
Estimate_adj = if_else(ubicacion_1 == aux_ideol1, Estimate, -1*Estimate),
upr_adj = Estimate_adj + abs((upr - lwr) / 2),
lwr_adj = Estimate_adj - abs((upr - lwr) / 2)
) %>%
arrange(ubicacion_1, ubicacion_2) %>%
select(ubicacion_1, ubicacion_2, Estimate_adj, upr_adj, lwr_adj, p.value)
comparaciones <- list(interaccion = interaction_adj,
ideologia = mainfx_ideologia_adj,
periodo = mainfx_Periodo_adj) %>%
map(~.[.[, "p.value"] <= 0.05,])
write_rds(comparaciones$interaccion, "interaccion_final.rds")
write_rds(comparaciones$ideologia, "ideologia_final.rds")
write_rds(comparaciones$periodo, "periodo_final.rds")
pooled_aov <- bind_rows(df_3273, df_3277, df_3279, df_3281) %>%
mutate(Periodo = factor(Periodo, levels = 3:6,
labels = c("Febrero", "Marzo",
"Abril", "Mayo")
),
ideologia = factor(ideol_pers, levels = 1:10)
)
pooled_aov %>%
group_by(ideologia, Periodo) %>%
summarise(media = Hmisc::wtd.mean(eval_pres, PESO),
se =sqrt(Hmisc::wtd.var(eval_pres, PESO)) / sqrt(n()),
uppr = media + 1.96 * se,
lwr = media - 1.96 * se) %>%
ggplot(aes(x = ideologia, y = media, group = Periodo, color = Periodo)) +
geom_line() +
geom_point() +
geom_errorbar(aes(ymin=lwr, ymax=uppr, width = .1)) +
labs(x = "Autoubicación ideológica (1-10)", y = "Valoración del presidente (1-10)")
mod_int <- lm(eval_pres ~ ideologia * Periodo, data=pooled_aov, weights = PESO)
mod_ad <- lm(eval_pres ~ ideologia + Periodo, data=pooled_aov, weights = PESO)
fit_int <- aov(mod_int)
fit_ad <- aov(mod_ad)
tukey_glht_sw_int <- glht(model = mod_int,
linfct = lsm(pairwise ~ ideologia:Periodo),
by = NULL,
vcov = sandwich)
tukey_glht_sw_ideologia <- glht(model = mod_ad,
linfct = mcp(ideologia = "Tukey"),
by = NULL,
vcov = sandwich)
tukey_glht_sw_Periodo <- glht(model = mod_ad,
linfct = mcp(Periodo = "Tukey"),
by = NULL,
vcov = sandwich)
intervals_glht_sw_int <- confint(tukey_glht_sw_int)$confint %>%
as.data.frame() %>%
rownames_to_column()
intervals_glht_sw_periodo <- confint(tukey_glht_sw_Periodo)$confint %>%
as.data.frame() %>%
rownames_to_column()
intervals_glht_sw_ideologia <- confint(tukey_glht_sw_ideologia)$confint %>%
as.data.frame() %>%
rownames_to_column()
intervals_glht_sw_int
interaction_glht_sw <- summary(tukey_glht_sw_int) %>%
broom::tidy() %>%
inner_join(intervals_glht_sw_int, by = c("lhs" = "rowname")) %>%
select(lhs, Estimate, lwr, upr, p.value) %>%
write_rds("interaction_glht_sw.rds")
interaction_adj <- interaction_glht_sw %>%
mutate(aux_ideol1 = str_match(lhs, pattern = "^(.*?),")[, 2] %>% as.numeric(),
aux_periodo1 = str_match(lhs, pattern = ",(.*?) - ")[, 2] %>%
factor(levels = levels(pooled_aov$Periodo)),
aux_ideol2  = str_match(lhs, pattern = "- (.*?),")[, 2] %>% as.numeric(),
aux_periodo2= word(lhs, 3, sep = fixed(',')) %>%
factor(levels = levels(pooled_aov$Periodo)),
periodo_1 = if_else(as.numeric(aux_periodo1) <= as.numeric(aux_periodo2),
aux_periodo1, aux_periodo2),
ubicacion_1 = if_else(aux_periodo1 == periodo_1,
if_else(aux_periodo1 == aux_periodo2,
pmin(aux_ideol1, aux_ideol2),
aux_ideol1),
aux_ideol2),
periodo_2 = if_else(aux_periodo1 == periodo_1, aux_periodo2, aux_periodo1),
ubicacion_2 = if_else(ubicacion_1 == aux_ideol1,
aux_ideol2,
aux_ideol1),
Estimate_adj = if_else(aux_ideol1 != ubicacion_1 | aux_periodo1 != periodo_1, -1*Estimate, Estimate),
upr_adj = Estimate_adj + abs((upr - lwr) / 2),
lwr_adj = Estimate_adj - abs((upr - lwr) / 2)
) %>%
arrange(ubicacion_1, periodo_1, periodo_2, ubicacion_2) %>%
select(ubicacion_1, periodo_1, ubicacion_2, periodo_2, Estimate_adj, upr_adj, lwr_adj, p.value)
mainfx_Periodo_glht_sw <- summary(tukey_glht_sw_Periodo) %>%
broom::tidy() %>%
inner_join(intervals_glht_sw_periodo, by = c("lhs" = "rowname")) %>%
select(lhs, Estimate, lwr, upr, p.value) %>%
write_rds("mainfx_Periodo_glht_sw.rds")
mainfx_Periodo_adj <- mainfx_Periodo_glht_sw %>%
mutate(aux_periodo1 = str_match(lhs, pattern = "^(.*?) -")[, 2] %>%
factor(levels = levels(pooled_aov$Periodo)),
aux_periodo2 = str_match(lhs, pattern = "- (.*?)$")[, 2] %>%
factor(levels = levels(pooled_aov$Periodo)),
periodo_1 = if_else(as.numeric(aux_periodo1) <= as.numeric(aux_periodo2),
aux_periodo1, aux_periodo2),
periodo_2 = if_else(aux_periodo1 == periodo_1, aux_periodo2, aux_periodo1),
Estimate_adj = if_else(periodo_1 == aux_periodo1, Estimate, -1*Estimate),
upr_adj = Estimate_adj + abs((upr - lwr) / 2),
lwr_adj = Estimate_adj - abs((upr - lwr) / 2)
) %>%
arrange(periodo_1, periodo_2) %>%
select(periodo_1, periodo_2, Estimate_adj, upr_adj, lwr_adj, p.value)
mainfx_ideologia_glht_sw <- summary(tukey_glht_sw_ideologia) %>%
broom::tidy() %>%
inner_join(intervals_glht_sw_ideologia, by = c("lhs" = "rowname")) %>%
select(lhs, Estimate, lwr, upr, p.value) %>%
write_rds("mainfx_ideologia_glht_sw.rds")
mainfx_ideologia_adj <- mainfx_ideologia_glht_sw %>%
mutate(aux_ideol1 = str_match(lhs, pattern = "^(.*?) -")[, 2] %>% as.numeric(),
aux_ideol2 = str_match(lhs, pattern = "- (.*?)$")[, 2] %>% as.numeric(),
ubicacion_1 = pmin(aux_ideol1, aux_ideol2),
ubicacion_2 = pmax(aux_ideol1, aux_ideol2),
Estimate_adj = if_else(ubicacion_1 == aux_ideol1, Estimate, -1*Estimate),
upr_adj = Estimate_adj + abs((upr - lwr) / 2),
lwr_adj = Estimate_adj - abs((upr - lwr) / 2)
) %>%
arrange(ubicacion_1, ubicacion_2) %>%
select(ubicacion_1, ubicacion_2, Estimate_adj, upr_adj, lwr_adj, p.value)
comparaciones <- list(interaccion = interaction_adj,
ideologia = mainfx_ideologia_adj,
periodo = mainfx_Periodo_adj) %>%
map(~.[.[, "p.value"] <= 0.05,])
write_rds(comparaciones$interaccion, "interaccion_final.rds")
write_rds(comparaciones$ideologia, "ideologia_final.rds")
write_rds(comparaciones$periodo, "periodo_final.rds")
comparaciones$interaccion
comparaciones$ideologia
with(comparaciones$interaccion, periodo_1 == "Febrero" & periodo_2 == "Marzo")
within(comparaciones$interaccion, periodo_1 == "Febrero" & periodo_2 == "Marzo")
within(comparaciones$interaccion, {periodo_1 == "Febrero" & periodo_2 == "Marzo"})
comparaciones$interaccion["ubicacion" == Febrero, ]
comparaciones$interaccion["ubicacion_1" == Febrero, ]
comparaciones$interaccion["ubicacion_1" == "Febrero", ]
comparaciones$interaccion[comparaciones$interaccion$ubicacion_1 == "Febrero", ]
a <- comparaciones$interaccion
a[a$ubicacion_1 == "1"]
a[a$ubicacion_1 == "1",]
a[a$ubicacion_1 == a$ubicacion_2, ]
a[a$periodo_1 == a$periodo_2, ]
view(a[a$periodo_1 == a$periodo_2, ])
max(abs(a$Estimate_adj[a$ubicacion_1 == a$ubicacion_2 - 1]))
a$ubicacion_1[a$Estimate_adj == 1.663415]
a$ubicacion_1[a$Estimate_adj == -1.663415]
a[a$ubicacion_1 == a$ubicacion_2 - 1])
a[a$ubicacion_1 == a$ubicacion_2 - 1]
a[a$ubicacion_1 == a$ubicacion_2 - 1, ]
pooled_aov %>%
group_by(ideologia, Periodo) %>%
summarise(media = Hmisc::wtd.mean(eval_pres, PESO),
se =sqrt(Hmisc::wtd.var(eval_pres, PESO)) / sqrt(n()),
uppr = media + 1.96 * se,
lwr = media - 1.96 * se) %>%
ggplot(aes(x = ideologia, y = media, group = Periodo, color = Periodo)) +
geom_line() +
geom_point() +
geom_errorbar(aes(ymin=lwr, ymax=uppr, width = .1)) +
labs(x = "Autoubicación ideológica (1-10)", y = "Valoración del presidente (1-10)") +
facet_wrap(~RV)
unique(pooled_aov$RV)
table(pooled_aov$RV)
ggplot(pooled_aov, aes(y = eval_pres, x = ideologia))+
stat_summary(fun=mean,geom="point",aes(group= Periodo,colour=Periodo))+
stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = .1, aes(group= Periodo,colour=Periodo))+
stat_summary(fun = mean, geom = "line",aes(group= Periodo,colour=Periodo)) +
labs(x = "Autoubicación ideológica (1-10)", y = "Valoración del presidente (1-10)") +
facet_wrap(~RV)
ggplot(pooled_aov, aes(y = eval_pres, x = ideologia))+
stat_summary(fun=mean,geom="point",aes(group= Periodo,colour=Periodo))+
stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = .1, aes(group= Periodo,colour=Periodo))+
stat_summary(fun = mean, geom = "line",aes(group= Periodo,colour=Periodo)) +
labs(x = "Autoubicación ideológica (1-10)", y = "Valoración del presidente (1-10)") +
facet_wrap(~RV, scales = "free")
a <- pooled_aov %>%
group_by(ideologia, Periodo) %>%
summarise(media = Hmisc::wtd.mean(eval_pres, PESO),
se =sqrt(Hmisc::wtd.var(eval_pres, PESO)) / sqrt(n()),
uppr = media + 1.96 * se,
lwr = media - 1.96 * se)
a
class(a)
ungroup(a)
class(ungroup(a))
ungroup(a) %>% ggplot(aes(x = ideologia, y = media, group = Periodo, color = Periodo)) +
geom_line() +
geom_point() +
geom_errorbar(aes(ymin=lwr, ymax=uppr, width = .1)) +
labs(x = "Autoubicación ideológica (1-10)", y = "Valoración del presidente (1-10)") +
facet_wrap(~RV)
pooled_aov[pooled_aov$RV == "PP",] %>%
group_by(ideologia, Periodo) %>%
summarise(media = Hmisc::wtd.mean(eval_pres, PESO),
se =sqrt(Hmisc::wtd.var(eval_pres, PESO)) / sqrt(n()),
uppr = media + 1.96 * se,
lwr = media - 1.96 * se) %>%
ggplot(aes(x = ideologia, y = media, group = Periodo, color = Periodo)) +
geom_line() +
geom_point() +
geom_errorbar(aes(ymin=lwr, ymax=uppr, width = .1)) +
labs(x = "Autoubicación ideológica (1-10)", y = "Valoración del presidente (1-10)")
nrow(pooled_aov[pooled_aov$RV == "PP" & pooled_aov$ideologia == 3])
nrow(pooled_aov[pooled_aov$RV == "PP" & pooled_aov$ideologia == 3, ])
nrow(pooled_aov[pooled_aov$RV == "PP" & pooled_aov$ideologia == 1, ])
nrow(pooled_aov[pooled_aov$RV == "PP" & pooled_aov$ideologia == 2, ])
nrow(pooled_aov[pooled_aov$RV == "PP" & pooled_aov$ideologia == 4, ])
nrow(pooled_aov[pooled_aov$RV == "PP" & pooled_aov$ideologia == 5, ])
nrow(pooled_aov[pooled_aov$RV == "PP" & pooled_aov$ideologia == 6, ])
nrow(pooled_aov[pooled_aov$RV == "PP" & pooled_aov$ideologia == 7, ])
nrow(pooled_aov[pooled_aov$RV == "PP" & pooled_aov$ideologia == 8, ])
nrow(pooled_aov[pooled_aov$RV == "PP" & pooled_aov$ideologia == 9, ])
nrow(pooled_aov[pooled_aov$RV == "PP" & pooled_aov$ideologia == 10, ])
nrow(pooled_aov[pooled_aov$RV == "MP" & pooled_aov$ideologia == 10, ])
nrow(pooled_aov[pooled_aov$RV == "MP" & pooled_aov$ideologia == 1, ])
nrow(pooled_aov[pooled_aov$RV == "MP" & pooled_aov$ideologia == 2, ])
nrow(pooled_aov[pooled_aov$RV == "MP" & pooled_aov$ideologia == 3, ])
nrow(pooled_aov[pooled_aov$RV == "MP" & pooled_aov$ideologia == 4, ])
nrow(pooled_aov[pooled_aov$RV == "MP" & pooled_aov$ideologia == 5, ])
bp <- ggplot(pooled_aov, aes(x=RV, y=ideologia, group=RV)) +
geom_boxplot(aes(fill=RV))
bp
bp + facet_wrap(~Periodo)
bp + facet_wrap(~Periodo) +coord_flip()
bp <- ggplot(pooled_aov, aes(x=RV, y=ideologia, group=RV, weight = PESO)) +
geom_boxplot(aes(fill=RV))
bp + facet_wrap(~Periodo) +coord_flip()
bp + facet_wrap(~Periodo) +coord_flip() + theme(axis.text.x = element_blank())
bp + facet_wrap(~Periodo) +coord_flip() + theme(axis.text.y = element_blank())
bp + facet_wrap(~Periodo, ncol = 4) +coord_flip() + theme(axis.text.y = element_blank())
pooled <- bind_rows(df_3269, df_3271, df_3273, df_3277, df_3279, df_3281) %>%
mutate(Periodo = factor(Periodo, levels = 1:6,
labels = c("Poselectoral", "Enero", "Febrero", "Marzo",
"Abril", "Mayo")
),
ideologia = factor(ideol_pers, levels = 1:10)
)
bp <- ggplot(pooled_aov, aes(x=RV, y=ideologia, group=RV, weight = PESO)) +
geom_boxplot(aes(fill=RV))
install.packages("gganimate")
library(gganimate)
install.packages("gifski")
install.packages("av")
library(gifski)
library(av)
library(gganimate)
bp <- ggplot(pooled_aov, aes(x=RV, y=ideologia, group=RV, weight = PESO)) +
geom_boxplot(aes(fill=RV))
bp + transition_states(Periodo)
a <- bp + transition_states(Periodo)
a
a <- bp + transition_time(Periodo)
a
a <- bp + transition_states(Periodo)
anim_save(a, filename = "prueba.giff")
anim <- ggplot(iris, aes(x = Petal.Width, y = Petal.Length)) +
geom_point(aes(colour = Species), size = 2) +
transition_states(Species,
transition_length = 2,
state_length = 1)
anim
getwd()
anim
file_renderer(dir = ".", prefix = "gganim_plot", overwrite = FALSE)
