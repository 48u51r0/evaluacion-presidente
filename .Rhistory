as.character(CUES))
),
PESO = 1,
Periodo = 5,
RV = case_when(RECUVOTOGR %in% c(5, 6, 21,67) ~ 5, #UP
RECUVOTOGR %in% c(7, 50) ~ 7,       #MPais
RECUVOTOGR == 1 ~ 1, #PP
RECUVOTOGR == 2 ~ 2, #PSOE
RECUVOTOGR == 4 ~ 4, #Cs
RECUVOTOGR == 18 ~ 18, #VOX
RECUVOTOGR >= 96 | RECUVOTOGR == 0 ~ NA_real_, #
TRUE ~ 99) %>%
factor(levels = c(1, 2, 4, 5, 7, 18, 99),
labels = c("PP", "PSOE", "Cs", "UP", "MP", "VOX", "Otros")
) %>%
relevel(2),
eval_pres = case_when(as.numeric(P31_1)  %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(P31_1)),
evalpres_GMC = eval_pres - weighted.mean(w = PESO, x = eval_pres, na.rm = TRUE),
P31_2 = case_when(as.numeric(P31_2) %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(P31_2)),
P31_3 = case_when(as.numeric(P31_3) %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(P31_3)),
P31_4 = case_when(as.numeric(P31_4) %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(P31_4)),
P31_5 = case_when(as.numeric(P31_5) %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(P31_5)),
P31_6 = case_when(as.numeric(P31_6) %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(P31_6)),
eval_opos = pmax(P31_2, P31_3, P31_4, P31_5, P31_6, na.rm = TRUE),
ideol_pers = case_when(as.numeric(ESCIDEOL)  %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(ESCIDEOL)),
ideol_GMC = ideol_pers - weighted.mean(w = PESO, x = ideol_pers, na.rm = TRUE),
ideol_2 = ideol_GMC^2,
ideol_3 = ideol_GMC^3,
ideol_pres = case_when(as.numeric(ESCIDEOLPOLI_1)  %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(ESCIDEOLPOLI_1)),
dist_ideo = ideol_pers - ideol_pres,
distideo_GMC= dist_ideo - weighted.mean(w = PESO, x = dist_ideo, na.rm = TRUE),
dist_eval = eval_pres - eval_opos,
distideo_2 = distideo_GMC^2,
distideo_3 = distideo_GMC^3,
man = case_when(SEXO == 1 ~ 1L,
SEXO == 2 ~ 0L,
TRUE ~ NA_integer_) %>%
factor(levels = c(0, 1),
labels = c("Mujer", "Hombre")
) %>%
relevel(1),
higher_educ = case_when(NIVELESTENTREV %in% c(1:7, 16) ~ 0L,
NIVELESTENTREV %in% 8:15 ~ 1L,
TRUE ~ NA_integer_) %>%
factor(levels = c(0, 1),
labels = c("Universitario", "No-Universitario")
) %>%
relevel(1),
welloff = case_when(CLASESOCIAL %in% 1:3 ~ 1L, #high, middle-high, middle-middle
CLASESOCIAL %in% 4:12 ~ 0L,
TRUE ~ NA_integer_) %>%
factor(levels = c(0, 1),
labels = c("Medio-alto", "Bajo")
) %>%
relevel(1)
) %>%
select(id, Periodo, dist_eval, eval_pres, evalpres_GMC, eval_opos, ideol_pers,ideol_GMC, ideol_2, ideol_3, distideo_GMC, distideo_2, distideo_3, RV, man, higher_educ, welloff, PESO) %>%
drop_na() %>%
write_rds("df_3279.rds")
# 5. Mayo----------------------------------------------------------------------
df_3281 <- read_rds("backup_3281.rds") %>%
mutate(id = as.numeric(
paste0(as.character(ESTUDIO),
as.character(CUES))
),
PESO = 1,
Periodo = 6,
RV = case_when(RECUVOTOGR %in% c(5, 6, 21,67) ~ 5, #UP
RECUVOTOGR %in% c(7, 50) ~ 7,       #MPais
RECUVOTOGR == 1 ~ 1, #PP
RECUVOTOGR == 2 ~ 2, #PSOE
RECUVOTOGR == 4 ~ 4, #Cs
RECUVOTOGR == 18 ~ 18, #VOX
RECUVOTOGR >= 96 | RECUVOTOGR == 0 ~ NA_real_, #
TRUE ~ 99) %>%
factor(levels = c(1, 2, 4, 5, 7, 18, 99),
labels = c("PP", "PSOE", "Cs", "UP", "MP", "VOX", "Otros")
) %>%
relevel(2),
eval_pres = case_when(as.numeric(P33_1)  %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(P33_1)),
evalpres_GMC = eval_pres - weighted.mean(w = PESO, x = eval_pres, na.rm = TRUE),
P33_2 = case_when(as.numeric(P33_2) %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(P33_2)),
P33_3 = case_when(as.numeric(P33_3) %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(P33_3)),
P33_4 = case_when(as.numeric(P33_4) %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(P33_4)),
P33_5 = case_when(as.numeric(P33_5) %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(P33_5)),
eval_opos = pmax(P33_2, P33_3, P33_4, P33_5, na.rm = TRUE),
ideol_pers = case_when(as.numeric(ESCIDEOL)  %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(ESCIDEOL)),
ideol_GMC = ideol_pers - weighted.mean(w = PESO, x = ideol_pers, na.rm = TRUE),
ideol_2 = ideol_GMC^2,
ideol_3 = ideol_GMC^3,
ideol_pres = case_when(as.numeric(ESCIDEOLPOLI_1)  %in% c(97, 98, 99) ~ NA_real_,
TRUE ~ as.numeric(ESCIDEOLPOLI_1)),
dist_ideo = ideol_pers - ideol_pres,
distideo_GMC= dist_ideo - weighted.mean(w = PESO, x = dist_ideo, na.rm = TRUE),
dist_eval = eval_pres - eval_opos,
ideol_2 = ideol_GMC^2,
ideol_3 = ideol_GMC^3,
distideo_2 = distideo_GMC^2,
distideo_3 = distideo_GMC^3,
man = case_when(SEXO == 1 ~ 1L,
SEXO == 2 ~ 0L,
TRUE ~ NA_integer_) %>%
factor(levels = c(0, 1),
labels = c("Mujer", "Hombre")
) %>%
relevel(1),
higher_educ = case_when(NIVELESTENTREV %in% c(1:8, 17) ~ 0L,
NIVELESTENTREV %in% 9:16 ~ 1L,
TRUE ~ NA_integer_) %>%
factor(levels = c(0, 1),
labels = c("Universitario", "No-Universitario")
) %>%
relevel(1),
welloff = case_when(CLASESOCIAL %in% 1:3 ~ 1L, #high, middle-high, middle-middle
CLASESOCIAL %in% 4:11 ~ 0L,
TRUE ~ NA_integer_) %>%
factor(levels = c(0, 1),
labels = c("Medio-alto", "Bajo")
) %>%
relevel(1)
) %>%
select(id, Periodo, dist_eval, eval_pres, evalpres_GMC, eval_opos, ideol_pers,ideol_GMC, ideol_2, ideol_3, distideo_GMC, distideo_2, distideo_3, RV, man, higher_educ, welloff, PESO) %>%
drop_na() %>%
write_rds("df_3281.rds")
#---------------Eliminamos objetos del Global Environment----------------------------------------
rm(list = ls())
df_3269 <- read_rds("df_3269.rds")
df_3271 <- read_rds("df_3271.rds")
df_3273 <- read_rds("df_3273.rds")
df_3277 <- read_rds("df_3277.rds")
df_3279 <- read_rds("df_3279.rds")
df_3281 <- read_rds("df_3281.rds")
lista_datos <- list(df_3269, df_3271, df_3273, df_3277, df_3279, df_3281)
models <- list("mod0" = mod0 ,"mod1" = mod1,"mod2"= mod2, "mod3"=mod3) %>%
map(~lm(.,
data= df_3269,
weights = PESO)
)
lmtest::lrtest(models$mod0, models$mod1)
lmtest::lrtest(models$mod1, models$mod2)
lmtest::lrtest(models$mod2, models$mod3)
mod0 <- "eval_pres~man+higher_educ+welloff"
mod1 <- "eval_pres~ideol_GMC + man+higher_educ+welloff"
mod2 <- "eval_pres~ideol_GMC + ideol_2  + man+higher_educ+welloff"
mod3 <- "eval_pres~ideol_GMC + ideol_2 + ideol_3 + man+higher_educ+welloff"
models <- list("mod0" = mod0 ,"mod1" = mod1,"mod2"= mod2, "mod3"=mod3) %>%
map(~lm(.,
data= df_3269,
weights = PESO)
)
lmtest::lrtest(models$mod0, models$mod1)
lmtest::lrtest(models$mod1, models$mod2)
lmtest::lrtest(models$mod2, models$mod3)
mod0 <- "eval_pres~man+higher_educ+welloff"
mod1 <- "eval_pres~ideol_GMC + man+higher_educ+welloff"
mod2 <- "eval_pres~ideol_GMC + ideol_2  + man+higher_educ+welloff"
mod3 <- "eval_pres~ideol_GMC + ideol_2 + ideol_3 + man+higher_educ+welloff"
models <- list("mod0" = mod0 ,"mod1" = mod1,"mod2"= mod2, "mod3"=mod3) %>%
map(~lm(.,
data= df_3269,
weights = PESO)
)
lmtest::lrtest(models$mod0, models$mod1)
lmtest::lrtest(models$mod1, models$mod2)
lmtest::lrtest(models$mod2, models$mod3)
mod0 <- "eval_pres~man+higher_educ+welloff"
mod1 <- "eval_pres~ideol_GMC + man+higher_educ+welloff"
mod2 <- "eval_pres~ideol_GMC + ideol_2  + man+higher_educ+welloff"
mod3 <- "eval_pres~ideol_GMC + ideol_2 + ideol_3 + man+higher_educ+welloff"
models <- list("mod0" = mod0 ,"mod1" = mod1,"mod2"= mod2, "mod3"=mod3) %>%
map(~lm(.,
data= df_32371,
weights = PESO)
)
lmtest::lrtest(models$mod0, models$mod1)
lmtest::lrtest(models$mod1, models$mod2)
lmtest::lrtest(models$mod2, models$mod3)
mod0 <- "eval_pres~man+higher_educ+welloff"
mod1 <- "eval_pres~ideol_GMC + man+higher_educ+welloff"
mod2 <- "eval_pres~ideol_GMC + ideol_2  + man+higher_educ+welloff"
mod3 <- "eval_pres~ideol_GMC + ideol_2 + ideol_3 + man+higher_educ+welloff"
models <- list("mod0" = mod0 ,"mod1" = mod1,"mod2"= mod2, "mod3"=mod3) %>%
map(~lm(.,
data= df_3271,
weights = PESO)
)
lmtest::lrtest(models$mod0, models$mod1)
lmtest::lrtest(models$mod1, models$mod2)
lmtest::lrtest(models$mod2, models$mod3)
mod0 <- "eval_pres~man+higher_educ+welloff"
mod1 <- "eval_pres~ideol_GMC + man+higher_educ+welloff"
mod2 <- "eval_pres~ideol_GMC + ideol_2  + man+higher_educ+welloff"
mod3 <- "eval_pres~ideol_GMC + ideol_2 + ideol_3 + man+higher_educ+welloff"
models <- list("mod0" = mod0 ,"mod1" = mod1,"mod2"= mod2, "mod3"=mod3) %>%
map(~lm(.,
data= df_3269,
weights = PESO)
)
lmtest::lrtest(models$mod0, models$mod1)
a <- lmtest::lrtest(models$mod0, models$mod1)
a
a$`Pr(>Chisq)`
a$`Pr(>Chisq)`[1]
a$`Pr(>Chisq)`[2]
?print
lrt <- function(data = data){
mod0 <- "eval_pres~man+higher_educ+welloff"
mod1 <- "eval_pres~ideol_GMC + man+higher_educ+welloff"
mod2 <- "eval_pres~ideol_GMC + ideol_2  + man+higher_educ+welloff"
mod3 <- "eval_pres~ideol_GMC + ideol_2 + ideol_3 + man+higher_educ+welloff"
models <- list("mod0" = mod0 ,"mod1" = mod1,"mod2"= mod2, "mod3"=mod3) %>%
map(~lm(.,
data = data,
weights = PESO)
)
tmp1 <- lmtest::lrtest(models$mod0, models$mod1)
tmp2 <- lmtest::lrtest(models$mod1, models$mod2)
tmp3 <- lmtest::lrtest(models$mod2, models$mod3)
message("p-val para mod0 versus mod1: ", tmp1$`Pr(>Chisq)`[2])
}
lrt(df_3269)
x <- c("a", "b", "aaaaaaaaaaa")
toString(x)
toString(df_3269)
names(df_3269)
paste(df_3269)
substitute(df_3269)
lrt <- function(data = data){
mod0 <- "eval_pres~man+higher_educ+welloff"
mod1 <- "eval_pres~ideol_GMC + man+higher_educ+welloff"
mod2 <- "eval_pres~ideol_GMC + ideol_2  + man+higher_educ+welloff"
mod3 <- "eval_pres~ideol_GMC + ideol_2 + ideol_3 + man+higher_educ+welloff"
models <- list("mod0" = mod0 ,"mod1" = mod1,"mod2"= mod2, "mod3"=mod3) %>%
map(~lm(.,
data = data,
weights = PESO)
)
tmp1 <- lmtest::lrtest(models$mod0, models$mod1)
tmp2 <- lmtest::lrtest(models$mod1, models$mod2)
tmp3 <- lmtest::lrtest(models$mod2, models$mod3)
message(substitute(data), ":p-val para mod0 versus mod1: ", tmp1$`Pr(>Chisq)`[2])
}
lrt(df_3269)
map(lista_datos, ~lrt(.))
lrt(df_3281)
map(lista_datos, ~lrt([[.]]))
map(lista_datos, ~lrt([[.]]))
map(lista_datos, ~lrt([[.]]))
map(lista_datos, ~lrt([.]))
map(lista_datos, ~lrt
map(lista_datos, ~lrt)
map(lista_datos, lrt)
str(lista_datos)
lista_datos[[1]]
substitute(lista_datos[[1]])
substitute(lista_datos[1])
lista_datos <- list(df_3269, df_3271, df_3273, df_3277, df_3279, df_3281)
#-----------------Several models of relations between DV and IV--------------
lrt <- function(data = data){
mod0 <- "eval_pres~man+higher_educ+welloff"
mod1 <- "eval_pres~ideol_GMC + man+higher_educ+welloff"
mod2 <- "eval_pres~ideol_GMC + ideol_2  + man+higher_educ+welloff"
mod3 <- "eval_pres~ideol_GMC + ideol_2 + ideol_3 + man+higher_educ+welloff"
models <- list("mod0" = mod0 ,"mod1" = mod1,"mod2"= mod2, "mod3"=mod3) %>%
map(~lm(.,
data = data,
weights = PESO)
)
tmp1 <- lmtest::lrtest(models$mod0, models$mod1)
tmp2 <- lmtest::lrtest(models$mod1, models$mod2)
tmp3 <- lmtest::lrtest(models$mod2, models$mod3)
message(quote(data), ":p-val para mod0 versus mod1: ", tmp1$`Pr(>Chisq)`[2])
}
map(lista_datos, lrt)
lista_datos <- list(df_3269, df_3271, df_3273, df_3277, df_3279, df_3281)
#-----------------Several models of relations between DV and IV--------------
lrt <- function(data = data){
mod0 <- "eval_pres~man+higher_educ+welloff"
mod1 <- "eval_pres~ideol_GMC + man+higher_educ+welloff"
mod2 <- "eval_pres~ideol_GMC + ideol_2  + man+higher_educ+welloff"
mod3 <- "eval_pres~ideol_GMC + ideol_2 + ideol_3 + man+higher_educ+welloff"
models <- list("mod0" = mod0 ,"mod1" = mod1,"mod2"= mod2, "mod3"=mod3) %>%
map(~lm(.,
data = data,
weights = PESO)
)
tmp1 <- lmtest::lrtest(models$mod0, models$mod1)
tmp2 <- lmtest::lrtest(models$mod1, models$mod2)
tmp3 <- lmtest::lrtest(models$mod2, models$mod3)
message(substitute(data), ":p-val para mod0 versus mod1: ", tmp1$`Pr(>Chisq)`[2])
}
map(lista_datos, lrt)
lrt(lista_data)
lrt(lista_datos[[1]])
lrt(lista_datos[1])
class(lista_datos[1])
class(lista_datos[[1]])
deparse(substitute(lista_datos[[1]]))
get(lista_datos[[1]])
lista_datos[[1]]
get(as.data.frame(lista_datos[[1]]))
comment(lista_datos[[1]])
comment(df_3269)
deparse(substitute(df_3269))
makeNamedList <- function(...) {
structure(list(...), names = as.list(substitute(list(...)))[-1L])
}
lista_datos <- list(df_3269, df_3271, df_3273, df_3277, df_3279, df_3281) %>%
makeNamedList()
names(lista_datos)
lista_datos[1]
str(lista_datos)
lista_datos <- makeNamedList(df_3269, df_3271, df_3273,
df_3277, df_3279, df_3281)
names(lista_datos)
lrt <- function(data = data){
mod0 <- "eval_pres~man+higher_educ+welloff"
mod1 <- "eval_pres~ideol_GMC + man+higher_educ+welloff"
mod2 <- "eval_pres~ideol_GMC + ideol_2  + man+higher_educ+welloff"
mod3 <- "eval_pres~ideol_GMC + ideol_2 + ideol_3 + man+higher_educ+welloff"
models <- list("mod0" = mod0 ,"mod1" = mod1,"mod2"= mod2, "mod3"=mod3) %>%
map(~lm(.,
data = data,
weights = PESO)
)
tmp1 <- lmtest::lrtest(models$mod0, models$mod1)
tmp2 <- lmtest::lrtest(models$mod1, models$mod2)
tmp3 <- lmtest::lrtest(models$mod2, models$mod3)
message(names(data), ":p-val para mod0 versus mod1: ", tmp1$`Pr(>Chisq)`[2])
}
map(lista_datos, lrt)
lrt(df_3269)
lista_datos <- list(df_3269, df_3271, df_3273,
df_3277, df_3279, df_3281)
#-----------------Several models of relations between DV and IV--------------
lrt <- function(data = data){
mod0 <- "eval_pres~man+higher_educ+welloff"
mod1 <- "eval_pres~ideol_GMC + man+higher_educ+welloff"
mod2 <- "eval_pres~ideol_GMC + ideol_2  + man+higher_educ+welloff"
mod3 <- "eval_pres~ideol_GMC + ideol_2 + ideol_3 + man+higher_educ+welloff"
models <- list("mod0" = mod0 ,"mod1" = mod1,"mod2"= mod2, "mod3"=mod3) %>%
map(~lm(.,
data = data,
weights = PESO)
)
tmp1 <- lmtest::lrtest(models$mod0, models$mod1)
tmp2 <- lmtest::lrtest(models$mod1, models$mod2)
tmp3 <- lmtest::lrtest(models$mod2, models$mod3)
message(substitute(data), ":p-val para mod0 versus mod1: ", tmp1$`Pr(>Chisq)`[2])
}
lrt(df_3269)
lrt <- function(data = data){
mod0 <- "eval_pres~man+higher_educ+welloff"
mod1 <- "eval_pres~ideol_GMC + man+higher_educ+welloff"
mod2 <- "eval_pres~ideol_GMC + ideol_2  + man+higher_educ+welloff"
mod3 <- "eval_pres~ideol_GMC + ideol_2 + ideol_3 + man+higher_educ+welloff"
models <- list("mod0" = mod0 ,"mod1" = mod1,"mod2"= mod2, "mod3"=mod3) %>%
map(~lm(.,
data = data,
weights = PESO)
)
tmp1 <- lmtest::lrtest(models$mod0, models$mod1)
tmp2 <- lmtest::lrtest(models$mod1, models$mod2)
tmp3 <- lmtest::lrtest(models$mod2, models$mod3)
message(substitute(data), ":p-val para mod0 versus mod1: ", tmp1$`Pr(>Chisq)`[2])
message(substitute(data), ":p-val para mod1 versus mod2: ", tmp2$`Pr(>Chisq)`[2])
message(substitute(data), ":p-val para mod2 versus mod3: ", tmp3$`Pr(>Chisq)`[2])
}
lrt(df_3269)
lrt(df_3269)
lrt(df_3271)
lrt(df_3273)
lrt(df_3277)
lrt(df_3279)
lrt(df_3281)
#-----------------Several models of relations between DV and IV--------------
lrt <- function(data = data){
mod0 <- "eval_pres~man+higher_educ+welloff"
mod1 <- "eval_pres~ideol_GMC + man+higher_educ+welloff"
mod2 <- "eval_pres~ideol_GMC + ideol_2  + man+higher_educ+welloff"
mod3 <- "eval_pres~ideol_GMC + ideol_2 + ideol_3 + man+higher_educ+welloff"
models <- list("mod0" = mod0 ,"mod1" = mod1,"mod2"= mod2, "mod3"=mod3) %>%
map(~lm(.,
data = data,
weights = PESO)
)
tmp1 <- lmtest::lrtest(models$mod0, models$mod1)
tmp2 <- lmtest::lrtest(models$mod1, models$mod2)
tmp3 <- lmtest::lrtest(models$mod2, models$mod3)
tmp4 <- lmtest::lrtest(models$mod1, models$mod3)
message(substitute(data), ":p-val para mod0 versus mod1: ", tmp1$`Pr(>Chisq)`[2])
message(substitute(data), ":p-val para mod1 versus mod2: ", tmp2$`Pr(>Chisq)`[2])
message(substitute(data), ":p-val para mod2 versus mod3: ", tmp3$`Pr(>Chisq)`[2])
message(substitute(data), ":p-val para mod1 versus mod3: ", tmp4$`Pr(>Chisq)`[2])
}
lrt(df_3269)
lrt(df_3271)
lrt(df_3273)
lrt(df_3277)
lrt(df_3279)
lrt(df_3281)
a <- map_df(lista_datos, bind_rows)
dim(a)
dim(a[[1]])
dim(lista_datos[[1]])
dim(lista_datos[[2]])
2-3*4
k_chow <- readRDS("C:/Users/natal/Desktop/Paper_08042020/k_chow.rds")
view(k_chow)
ormula <- mod3_unrestr
formula_res <- mod3_restr
k_chow <- read_rds("k_chow.rds")
pooled <- bind_rows(pre, post) %>%
mutate(breakpoint = case_when(Periodo == min(Periodo) ~ 0,
Periodo == max(Periodo) ~ 1) %>%
factor()
)
formula <- mod3_unrestr
formula_res <- mod3_restr
k_chow <- read_rds("k_chow.rds")
pooled <- bind_rows(pre, post) %>%
mutate(breakpoint = case_when(Periodo == min(Periodo) ~ 0,
Periodo == max(Periodo) ~ 1) %>%
factor()
)
pre <- df_3269
post <- df_3271
significance <- 0.01
mod3_unrestr <- "eval_pres ~ breakpoint*ideol_GMC + breakpoint*ideol_2 +
breakpoint*ideol_3 + man + higher_educ + welloff"
mod3_restr <- "eval_pres ~ ideol_GMC + ideol_2 + ideol_3 +
man+higher_educ+welloff"
formula <- mod3_unrestr
formula_res <- mod3_restr
k_chow <- read_rds("k_chow.rds")
pooled <- bind_rows(pre, post) %>%
mutate(breakpoint = case_when(Periodo == min(Periodo) ~ 0,
Periodo == max(Periodo) ~ 1) %>%
factor()
)
linear_res <- lm(formula_res, data = pooled, weights = PESO)
linear <- lm(formula, data = pooled, weights = PESO)
robust <- robustbase::lmrob(formula, data = pooled, weights = PESO)
K <- cbind(diag(length(coef(robust))))
rownames(K) <- names(coef(robust))
aux_linear_chow <- glht(linear, linfct = k_chow, vcov =sandwich)
aux_linear_completo <- glht(linear, linfct = K, vcov= sandwich)
aux_robust_chow <- glht(robust, linfct = k_chow)
aux_robust_completo <- glht(robust, linfct = K)
linear_chow <- summary(aux_linear_chow, test = Ftest())
robust_chow <- summary(aux_robust_chow, test =Ftest())
linear_completo <- summary(aux_linear_completo)
robust_completo <- summary(aux_robust_completo)
linear_completo
robust_completo
k
K
View(K)
robust_chow$test$df
linear_chow$test$df
robust_chow$test$fstat
linear_chow$test$fstat
a <- 1
1 %in% a
a <- c(1,2)
1 %in% a
3 %in% a
nobs(linear)
nobs(robust)
nobs(robust_chow)
nobs(robust_completo)
pre <- df_3269
post <- df_3271
significance <- 0.01
mod3_unrestr <- "eval_pres ~ breakpoint*ideol_GMC + breakpoint*ideol_2 +
breakpoint*ideol_3 + man + higher_educ + welloff"
mod3_restr <- "eval_pres ~ ideol_GMC + ideol_2 + ideol_3 +
man+higher_educ+welloff"
#Dummy Chow function
unrestricted <- mod3_unrestr
restricted <- mod3_restr
#definimos el pooled data set con una dummy de punto discontinuidad
pooled <- bind_rows(pre, post) %>%
mutate(breakpoint = case_when(Periodo == min(Periodo) ~ 0,
Periodo == max(Periodo) ~ 1) %>%
factor()
)
#definimos los modelos lineales y robusto
lin_restr <- lm(restricted, data = pooled, weights = PESO)
lin_unrestr <- lm(unrestricted, data = pooled, weights = PESO)
robust_unrestr <- robustbase::lmrob(unrestricted, data = pooled, weights = PESO)
#definimos las matrices de hipótesis (multcomp)
k_chow <- read_rds("k_chow.rds") #Solo los coeficientes con la dummy son = 0
K <- cbind(diag(length(coef(robust_unrestr)))) #todos los coeficientes = 0
rownames(K) <- names(coef(robust_unrestr))
aux_linear_chow <- glht(lin_unrestr, linfct = k_chow, vcov =sandwich)
aux_robust_chow <- glht(robust_unrestr, linfct = k_chow)
aux_linear_chow
